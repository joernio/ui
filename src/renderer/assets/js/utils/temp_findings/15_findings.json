[{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"0faab86059cec4d8e185382166a9f583","source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":34,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":6,"id":3074457345618925600},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":34,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":6,"id":3074457345618925600},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},{"dynamicTypeHintFullName":[],"name":"_req$query","internalFlags":4,"code":"_req$query","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-28,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":7,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":19,"order":1,"depthFirstOrder":-27,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":7,"id":3074457345618925600},{"internalFlags":4,"code":"query","columnNumber":19,"order":2,"depthFirstOrder":-26,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":7,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-25,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"_req$query = req.query","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-24,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":3074457345618925600},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"_req$query = req.query","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-24,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"username","internalFlags":4,"code":"username","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-23,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":8,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_req$query","internalFlags":4,"code":"_req$query","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-22,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":8,"id":3074457345618925600},{"internalFlags":4,"code":"username","columnNumber":17,"order":2,"depthFirstOrder":-21,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"username","lineNumber":8,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_req$query.username","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-20,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"username = _req$query.username","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-19,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-18,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_req$query","internalFlags":4,"code":"_req$query","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":3074457345618925600},{"internalFlags":4,"code":"password","columnNumber":17,"order":2,"depthFirstOrder":-16,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"password","lineNumber":9,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_req$query.password","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-15,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"password = _req$query.password","typeFullName":"","columnNumber":2,"order":3,"depthFirstOrder":-14,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":3074457345618925600},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"password = _req$query.password","typeFullName":"","columnNumber":2,"order":3,"depthFirstOrder":-14,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":3074457345618925600},{"dynamicTypeHintFullName":["__whatwg.console"],"name":"console","internalFlags":4,"code":"console","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-13,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":3074457345618925600},{"internalFlags":4,"code":"log","columnNumber":2,"order":2,"depthFirstOrder":-12,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"log","lineNumber":10,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"console.log","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-11,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600},{"dynamicTypeHintFullName":["__whatwg.console"],"name":"console","internalFlags":4,"code":"console","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-10,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":10,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":3074457345618925600},{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600},{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""}],"branchPoints":[],"sink":{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000},"node":{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":3074457345618925600}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":34,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":6,"id":3074457345618925600}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-25,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":3074457345618925600}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"_req$query","internalFlags":4,"code":"_req$query","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-28,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":7,"id":3074457345618925600}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_req$query.password","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-15,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":3074457345618925600}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"authentication","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"internal-secrets","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"password","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-18,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":3074457345618925600}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":3074457345618925600}},{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000}}],"id":4355481239626405000},"dstTags":[{"id":4355481239626405400,"name":"DATA_TYPE","value":"authentication","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"internal-secrets","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"password","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"log","_label":"TAG"},{"id":4355481239626405400,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000},"node":{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":3074457345618925600}},"id":4355481239626405400,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"}],"sourceDescriptorFlows":[],"dataTags":[{"id":4355481239626405400,"name":"DATA_TYPE","value":"authentication","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"internal-secrets","_label":"TAG"},{"id":4355481239626405400,"name":"SOURCE_VARIABLE","value":"req","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"password","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626405400,"name":"DEST_VARIABLE","value":"password","_label":"TAG"}],"sourceTags":[{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting\"","_label":"TAG"}],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"http-to-log","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Sensitive Data Leak: Security-sensitive data is leaked via `req` to log in `anonymous`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"2.5","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"a3-sensitive-data-exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP data is written to a log file in this flow. This data may be visible to a third party that has access to the logs, such as system administrators. Many web applications and APIs do not protect sensitive data, such as financial and healthcare. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes.\n\n\n## Countermeasures\n\nThis vulnerability can be prevented by not writing HTTP data directly to the log or by encrypting it in advance.\n\n## Additional information\n\n**[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n\n**[CWE-117](https://cwe.mitre.org/data/definitions/117.html)**\n\n**[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"https://cwe.mitre.org/data/definitions/117.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Sensitive Data Leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/sensitive.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^__whatwg.console^.log","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"3dd3ab3c87a5c742a6499f0afbdbe69a","source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting2\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":35,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":13,"id":3074457345618925600},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting2\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":35,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":13,"id":3074457345618925600},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-26,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":14,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-25,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":14,"id":3074457345618925600},{"internalFlags":4,"code":"session","columnNumber":6,"order":2,"depthFirstOrder":-24,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"session","lineNumber":14,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.session","typeFullName":"","columnNumber":6,"order":2,"depthFirstOrder":-23,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"(_tmp_0 = req.session)","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-22,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3074457345618925600},{"internalFlags":4,"code":"isAuthenticated","columnNumber":6,"order":2,"depthFirstOrder":-21,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"isAuthenticated","lineNumber":14,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"(_tmp_0 = req.session).isAuthenticated","typeFullName":"","columnNumber":6,"order":0,"depthFirstOrder":-20,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-19,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":14,"id":3074457345618925600},{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-18,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":14,"id":3074457345618925600},{"dynamicTypeHintFullName":["__whatwg.console"],"name":"console","internalFlags":4,"code":"console","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":15,"id":3074457345618925600},{"internalFlags":4,"code":"log","columnNumber":4,"order":2,"depthFirstOrder":-16,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"log","lineNumber":15,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"console.log","typeFullName":"","columnNumber":4,"order":0,"depthFirstOrder":-15,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600},{"dynamicTypeHintFullName":["__whatwg.console"],"name":"console","internalFlags":4,"code":"console","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-14,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":15,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":16,"order":1,"depthFirstOrder":-13,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":15,"id":3074457345618925600},{"internalFlags":4,"code":"query","columnNumber":16,"order":2,"depthFirstOrder":-12,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":15,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":16,"order":1,"depthFirstOrder":-11,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600},{"internalFlags":4,"code":"password","columnNumber":16,"order":2,"depthFirstOrder":-10,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"password","lineNumber":15,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.password","typeFullName":"","columnNumber":16,"order":2,"depthFirstOrder":-9,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600},{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600},{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""}],"branchPoints":[{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-18,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":14,"id":3074457345618925600}],"sink":{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000},"node":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.password","typeFullName":"","columnNumber":16,"order":2,"depthFirstOrder":-9,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting2\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":35,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":13,"id":3074457345618925600}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting2\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.password","typeFullName":"","columnNumber":16,"order":2,"depthFirstOrder":-9,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600}},{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000}}],"id":4355481239626405000},"dstTags":[{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"log","_label":"TAG"},{"id":4355481239626405400,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000},"node":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.password","typeFullName":"","columnNumber":16,"order":2,"depthFirstOrder":-9,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600}},"id":4355481239626405400,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"}],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[{"id":4355481239626405400,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting2\"","_label":"TAG"},{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"}],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"http-to-log","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Sensitive Data Leak: Security-sensitive data is leaked via `req` to log in `anonymous1`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"2.5","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"a3-sensitive-data-exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP data is written to a log file in this flow. This data may be visible to a third party that has access to the logs, such as system administrators. Many web applications and APIs do not protect sensitive data, such as financial and healthcare. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes.\n\n\n## Countermeasures\n\nThis vulnerability can be prevented by not writing HTTP data directly to the log or by encrypting it in advance.\n\n## Additional information\n\n**[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n\n**[CWE-117](https://cwe.mitre.org/data/definitions/117.html)**\n\n**[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"https://cwe.mitre.org/data/definitions/117.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Sensitive Data Leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/sensitive.js::program:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^__whatwg.console^.log","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"6ed7632018d85f00d60121e31b2062ea","source":{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":35,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":20,"id":3074457345618925600},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":35,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":20,"id":3074457345618925600},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},{"dynamicTypeHintFullName":[],"name":"_req$query2","internalFlags":4,"code":"_req$query2","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-50,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":21,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":20,"order":1,"depthFirstOrder":-49,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":21,"id":3074457345618925600},{"internalFlags":4,"code":"query","columnNumber":20,"order":2,"depthFirstOrder":-48,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":21,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":20,"order":2,"depthFirstOrder":-47,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"_req$query2 = req.query","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-46,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"_req$query2 = req.query","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-46,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"username","internalFlags":4,"code":"username","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-45,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":22,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_req$query2","internalFlags":4,"code":"_req$query2","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-44,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":22,"id":3074457345618925600},{"internalFlags":4,"code":"username","columnNumber":17,"order":2,"depthFirstOrder":-43,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"username","lineNumber":22,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_req$query2.username","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-42,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":22,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"username = _req$query2.username","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-41,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"username = _req$query2.username","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-41,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-40,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":23,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_req$query2","internalFlags":4,"code":"_req$query2","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-39,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":23,"id":3074457345618925600},{"internalFlags":4,"code":"password","columnNumber":17,"order":2,"depthFirstOrder":-38,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"password","lineNumber":23,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_req$query2.password","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-37,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":23,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"password = _req$query2.password","typeFullName":"","columnNumber":2,"order":3,"depthFirstOrder":-36,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-35,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":24,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_tmp_1","internalFlags":4,"code":"_tmp_1","typeFullName":"ANY","columnNumber":13,"order":1,"depthFirstOrder":-34,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":24,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"data = {}","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-33,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":24,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_tmp_2","internalFlags":4,"code":"_tmp_2","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-32,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":26,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":26,"id":3074457345618925600},{"internalFlags":4,"code":"session","columnNumber":6,"order":2,"depthFirstOrder":-30,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"session","lineNumber":26,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.session","typeFullName":"","columnNumber":6,"order":2,"depthFirstOrder":-29,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":26,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"(_tmp_2 = req.session)","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-28,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":26,"id":3074457345618925600},{"internalFlags":4,"code":"isAuthenticated","columnNumber":6,"order":2,"depthFirstOrder":-27,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"isAuthenticated","lineNumber":26,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"(_tmp_2 = req.session).isAuthenticated","typeFullName":"","columnNumber":6,"order":0,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":26,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_tmp_2","internalFlags":4,"code":"_tmp_2","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-25,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":26,"id":3074457345618925600},{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-24,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":26,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-23,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":27,"id":3074457345618925600},{"internalFlags":4,"code":"username","columnNumber":4,"order":2,"depthFirstOrder":-22,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"username","lineNumber":27,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"data.username","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-21,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":27,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"username","internalFlags":4,"code":"username","typeFullName":"ANY","columnNumber":20,"order":2,"depthFirstOrder":-20,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":27,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"data.username = username","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-19,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":27,"id":3074457345618925600},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"data.username = username","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-19,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":27,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-18,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":28,"id":3074457345618925600},{"internalFlags":4,"code":"password","columnNumber":4,"order":2,"depthFirstOrder":-17,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"password","lineNumber":28,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"data.password","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-16,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":28,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":20,"order":2,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":28,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"data.password = password","typeFullName":"","columnNumber":4,"order":2,"depthFirstOrder":-14,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":28,"id":3074457345618925600},{"dynamicTypeHintFullName":["__whatwg.console"],"name":"console","internalFlags":4,"code":"console","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-13,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600},{"internalFlags":4,"code":"log","columnNumber":2,"order":2,"depthFirstOrder":-12,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"log","lineNumber":31,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"console.log","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-11,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":31,"id":3074457345618925600},{"dynamicTypeHintFullName":["__whatwg.console"],"name":"console","internalFlags":4,"code":"console","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-10,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":31,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600},{"name":"","internalFlags":4,"code":"console.log(data)","typeFullName":"","columnNumber":2,"order":6,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":31,"id":3074457345618925600},{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""}],"branchPoints":[],"sink":{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"console.log(data)","typeFullName":"","columnNumber":2,"order":6,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":31,"id":3074457345618925600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000},"node":{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":35,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":20,"id":3074457345618925600}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":20,"order":2,"depthFirstOrder":-47,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"_req$query2","internalFlags":4,"code":"_req$query2","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-50,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":21,"id":3074457345618925600}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_req$query2.username","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-42,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":22,"id":3074457345618925600}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"credentials","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"credentials","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"pii","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"pii","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"clientManage","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"spottrek","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"username","internalFlags":4,"code":"username","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-45,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":22,"id":3074457345618925600}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"username","internalFlags":4,"code":"username","typeFullName":"ANY","columnNumber":20,"order":2,"depthFirstOrder":-20,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":27,"id":3074457345618925600}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"data.username","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-21,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":27,"id":3074457345618925600}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600}},{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000}}],"id":4355481239626405000},"dstTags":[{"id":4355481239626405400,"name":"DATA_TYPE","value":"clientManage","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"credentials","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"pii","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"log","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"spottrek","_label":"TAG"},{"id":4355481239626405400,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"console.log(data)","typeFullName":"","columnNumber":2,"order":6,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":31,"id":3074457345618925600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000},"node":{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600}},"id":4355481239626405400,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"}],"sourceDescriptorFlows":[],"dataTags":[{"id":4355481239626405400,"name":"SOURCE_VARIABLE","value":"req","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"clientManage","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"credentials","_label":"TAG"},{"id":4355481239626405400,"name":"DEST_VARIABLE","value":"data","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"pii","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"spottrek","_label":"TAG"}],"sourceTags":[{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"}],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"http-to-log","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Sensitive Data Leak: Security-sensitive data is leaked via `req` to log in `anonymous2`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"2.5","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"a3-sensitive-data-exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP data is written to a log file in this flow. This data may be visible to a third party that has access to the logs, such as system administrators. Many web applications and APIs do not protect sensitive data, such as financial and healthcare. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes.\n\n\n## Countermeasures\n\nThis vulnerability can be prevented by not writing HTTP data directly to the log or by encrypting it in advance.\n\n## Additional information\n\n**[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n\n**[CWE-117](https://cwe.mitre.org/data/definitions/117.html)**\n\n**[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"https://cwe.mitre.org/data/definitions/117.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Sensitive Data Leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/sensitive.js::program:anonymous2","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^__whatwg.console^.log","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"f36779c08754c6bf6fe1b474dd2b4ae5","source":{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":35,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":20,"id":3074457345618925600},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":35,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":20,"id":3074457345618925600},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},{"dynamicTypeHintFullName":[],"name":"_req$query2","internalFlags":4,"code":"_req$query2","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-50,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":21,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":20,"order":1,"depthFirstOrder":-49,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":21,"id":3074457345618925600},{"internalFlags":4,"code":"query","columnNumber":20,"order":2,"depthFirstOrder":-48,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":21,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":20,"order":2,"depthFirstOrder":-47,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"_req$query2 = req.query","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-46,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"_req$query2 = req.query","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-46,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"username","internalFlags":4,"code":"username","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-45,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":22,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_req$query2","internalFlags":4,"code":"_req$query2","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-44,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":22,"id":3074457345618925600},{"internalFlags":4,"code":"username","columnNumber":17,"order":2,"depthFirstOrder":-43,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"username","lineNumber":22,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_req$query2.username","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-42,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":22,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"username = _req$query2.username","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-41,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-40,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":23,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_req$query2","internalFlags":4,"code":"_req$query2","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-39,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":23,"id":3074457345618925600},{"internalFlags":4,"code":"password","columnNumber":17,"order":2,"depthFirstOrder":-38,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"password","lineNumber":23,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_req$query2.password","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-37,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":23,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"password = _req$query2.password","typeFullName":"","columnNumber":2,"order":3,"depthFirstOrder":-36,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"password = _req$query2.password","typeFullName":"","columnNumber":2,"order":3,"depthFirstOrder":-36,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-35,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":24,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_tmp_1","internalFlags":4,"code":"_tmp_1","typeFullName":"ANY","columnNumber":13,"order":1,"depthFirstOrder":-34,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":24,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"data = {}","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-33,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":24,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_tmp_2","internalFlags":4,"code":"_tmp_2","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-32,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":26,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":26,"id":3074457345618925600},{"internalFlags":4,"code":"session","columnNumber":6,"order":2,"depthFirstOrder":-30,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"session","lineNumber":26,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.session","typeFullName":"","columnNumber":6,"order":2,"depthFirstOrder":-29,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":26,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"(_tmp_2 = req.session)","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-28,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":26,"id":3074457345618925600},{"internalFlags":4,"code":"isAuthenticated","columnNumber":6,"order":2,"depthFirstOrder":-27,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"isAuthenticated","lineNumber":26,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"(_tmp_2 = req.session).isAuthenticated","typeFullName":"","columnNumber":6,"order":0,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":26,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"_tmp_2","internalFlags":4,"code":"_tmp_2","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-25,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":26,"id":3074457345618925600},{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-24,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":26,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-23,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":27,"id":3074457345618925600},{"internalFlags":4,"code":"username","columnNumber":4,"order":2,"depthFirstOrder":-22,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"username","lineNumber":27,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"data.username","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-21,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":27,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"username","internalFlags":4,"code":"username","typeFullName":"ANY","columnNumber":20,"order":2,"depthFirstOrder":-20,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":27,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"data.username = username","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-19,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":27,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-18,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":28,"id":3074457345618925600},{"internalFlags":4,"code":"password","columnNumber":4,"order":2,"depthFirstOrder":-17,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"password","lineNumber":28,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"data.password","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-16,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":28,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":20,"order":2,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":28,"id":3074457345618925600},{"name":"<operator>.assignment","internalFlags":4,"code":"data.password = password","typeFullName":"","columnNumber":4,"order":2,"depthFirstOrder":-14,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":28,"id":3074457345618925600},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"data.password = password","typeFullName":"","columnNumber":4,"order":2,"depthFirstOrder":-14,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":28,"id":3074457345618925600},{"dynamicTypeHintFullName":["__whatwg.console"],"name":"console","internalFlags":4,"code":"console","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-13,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600},{"internalFlags":4,"code":"log","columnNumber":2,"order":2,"depthFirstOrder":-12,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"log","lineNumber":31,"id":3074457345618925600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"console.log","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-11,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":31,"id":3074457345618925600},{"dynamicTypeHintFullName":["__whatwg.console"],"name":"console","internalFlags":4,"code":"console","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-10,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":31,"id":3074457345618925600},{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600},{"name":"","internalFlags":4,"code":"console.log(data)","typeFullName":"","columnNumber":2,"order":6,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":31,"id":3074457345618925600},{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""}],"branchPoints":[],"sink":{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"console.log(data)","typeFullName":"","columnNumber":2,"order":6,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":31,"id":3074457345618925600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000},"node":{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":35,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":20,"id":3074457345618925600}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":20,"order":2,"depthFirstOrder":-47,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":21,"id":3074457345618925600}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"_req$query2","internalFlags":4,"code":"_req$query2","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-50,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":21,"id":3074457345618925600}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_req$query2.password","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-37,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":23,"id":3074457345618925600}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"authentication","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"internal-secrets","_label":"TAG"},{"id":4355481239626404000,"name":"DATA_TYPE","value":"password","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-40,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":23,"id":3074457345618925600}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"password","internalFlags":4,"code":"password","typeFullName":"ANY","columnNumber":20,"order":2,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":28,"id":3074457345618925600}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"data.password","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-16,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":28,"id":3074457345618925600}},{"method":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600}},{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000}}],"id":4355481239626405000},"dstTags":[{"id":4355481239626405400,"name":"DATA_TYPE","value":"authentication","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"internal-secrets","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"password","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"},{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"log","_label":"TAG"},{"id":4355481239626405400,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^__whatwg.console^.log","astParentFullName":"<global>","fullName":"^__whatwg.console^.log","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626395000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"log","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"console.log(data)","typeFullName":"","columnNumber":2,"order":6,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":31,"id":3074457345618925600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626395000},"node":{"dynamicTypeHintFullName":[],"name":"data","internalFlags":4,"code":"data","typeFullName":"ANY","columnNumber":14,"order":2,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":31,"id":3074457345618925600}},"id":4355481239626405400,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[{"name":"anonymous2","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous2","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-51,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous2","isExternal":false,"lineNumber":20,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"}],"sourceDescriptorFlows":[],"dataTags":[{"id":4355481239626405400,"name":"DATA_TYPE","value":"authentication","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"internal-secrets","_label":"TAG"},{"id":4355481239626405400,"name":"SOURCE_VARIABLE","value":"req","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"password","_label":"TAG"},{"id":4355481239626405400,"name":"DEST_VARIABLE","value":"data","_label":"TAG"},{"id":4355481239626405400,"name":"DATA_TYPE","value":"sensitive","_label":"TAG"}],"sourceTags":[{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD_ROUTE","value":"\"/greeting3\"","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"}],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"http-to-log","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Sensitive Data Leak: Security-sensitive data is leaked via `req` to log in `anonymous2`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"2.5","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"a3-sensitive-data-exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP data is written to a log file in this flow. This data may be visible to a third party that has access to the logs, such as system administrators. Many web applications and APIs do not protect sensitive data, such as financial and healthcare. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes.\n\n\n## Countermeasures\n\nThis vulnerability can be prevented by not writing HTTP data directly to the log or by encrypting it in advance.\n\n## Additional information\n\n**[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n\n**[CWE-117](https://cwe.mitre.org/data/definitions/117.html)**\n\n**[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"https://cwe.mitre.org/data/definitions/117.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Sensitive Data Leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/sensitive.js::program:anonymous2","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^__whatwg.console^.log","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"f5792b094d2f5747b4d51e8225d093b1","source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":31,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":31,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":19,"order":1,"depthFirstOrder":-30,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500},{"internalFlags":4,"code":"query","columnNumber":19,"order":2,"depthFirstOrder":-29,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":19,"order":1,"depthFirstOrder":-28,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"internalFlags":4,"code":"path","columnNumber":19,"order":2,"depthFirstOrder":-27,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"path","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.path","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"followPath = req.query.path","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-25,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"followPath = req.query.path","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-25,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-24,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-23,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":1793433451611456500},{"internalFlags":4,"code":"session","columnNumber":6,"order":2,"depthFirstOrder":-22,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"session","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.session","typeFullName":"","columnNumber":6,"order":2,"depthFirstOrder":-21,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"(_tmp_0 = req.session)","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-20,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"internalFlags":4,"code":"isAuthenticated","columnNumber":6,"order":2,"depthFirstOrder":-19,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"isAuthenticated","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"(_tmp_0 = req.session).isAuthenticated","typeFullName":"","columnNumber":6,"order":0,"depthFirstOrder":-18,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":11,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-16,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":12,"id":1793433451611456500},{"internalFlags":4,"code":"redirect","columnNumber":4,"order":2,"depthFirstOrder":-8,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"redirect","lineNumber":12,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.redirect","typeFullName":"","columnNumber":4,"order":0,"depthFirstOrder":-7,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\"http://example.com/\"","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-5,"_label":"LITERAL","argumentIndex":1,"lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":41,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":12,"id":1793433451611456500},{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""}],"branchPoints":[{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-16,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500}],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":31,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.path","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":41,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":12,"id":1793433451611456500}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500}},{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700}}],"id":4355481239626405000},"dstTags":[{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"},{"id":4355481239626405400,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500}},"id":4355481239626405400,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"}],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"}],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"open-redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Open Redirect: HTTP Request parameters are used in HTTP redirects via `req` in `anonymous`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"3.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"a1-injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP Request parameters are not escaped and used in a HTTP redirect. This indicates an open redirect which can be exploited by an attacker to launch phishing attacks and/or steal sensitive data.\n\n## Countermeasures\n\n This vulnerability can be prevented by ensuring that users cannot arbitrarily control where your page redirects them to.\n\n## Additional information\n\n**[CWE-601](https://cwe.mitre.org/data/definitions/601.html)**\n\n**[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"https://cwe.mitre.org/data/definitions/601.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Open Redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/redirect.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^express.Response^.redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"7548c86be44221fce91c2015807f5184","source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":30,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":30,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":22,"order":1,"depthFirstOrder":-14,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500},{"internalFlags":4,"code":"query","columnNumber":22,"order":2,"depthFirstOrder":-13,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-12,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"internalFlags":4,"code":"url","columnNumber":22,"order":2,"depthFirstOrder":-11,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"url","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.url","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-10,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"encodeURI","astParentFullName":"<global>","fullName":"encodeURI","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398700,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626398700},{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"url = encodeURI(req.query.url)","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-8,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"url = encodeURI(req.query.url)","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-8,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-7,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500},{"internalFlags":4,"code":"redirect","columnNumber":2,"order":2,"depthFirstOrder":-6,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"redirect","lineNumber":20,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.redirect","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-5,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":20,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""}],"branchPoints":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":30,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.url","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-10,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500}},{"method":{"name":"encodeURI","astParentFullName":"<global>","fullName":"encodeURI","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"+encoded","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_TRANSFORM","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"encode","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626398700}},{"method":{"name":"encodeURI","astParentFullName":"<global>","fullName":"encodeURI","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"+encoded","_label":"TAG"},{"id":4355481239626403300,"name":"FROM_OUTSIDE","value":"","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_TRANSFORM","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"encode","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626398700}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500}},{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700}}],"id":4355481239626405000},"dstTags":[{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405400,"name":"TRANSFORMER_TYPE","value":"encoded","_label":"TAG"},{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"},{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500}},"id":4355481239626405400,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"}],"sourceDescriptorFlows":[],"dataTags":[{"id":4355481239626405400,"name":"SOURCE_VARIABLE","value":"req","_label":"TAG"},{"id":4355481239626405400,"name":"TRANSFORMER_TYPE","value":"encoded","_label":"TAG"},{"id":4355481239626405400,"name":"DEST_VARIABLE","value":"url","_label":"TAG"}],"sourceTags":[{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"},{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"}],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"open-redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Open Redirect: HTTP Request parameters are used in HTTP redirects via `req` in `anonymous1`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"3.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"a1-injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP Request parameters are not escaped and used in a HTTP redirect. This indicates an open redirect which can be exploited by an attacker to launch phishing attacks and/or steal sensitive data.\n\n## Countermeasures\n\n This vulnerability can be prevented by ensuring that users cannot arbitrarily control where your page redirects them to.\n\n## Additional information\n\n**[CWE-601](https://cwe.mitre.org/data/definitions/601.html)**\n\n**[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"https://cwe.mitre.org/data/definitions/601.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Open Redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/redirect.js::program:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^express.Response^.redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"b462792953f555d02d2e17f118828a73","source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"DESCRIPTOR","value":"http","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpResponse"],"name":"res","evaluationStrategy":"BY_VALUE","code":"res","typeFullName":"","columnNumber":35,"order":2,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"DESCRIPTOR","value":"http","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpResponse"],"name":"res","evaluationStrategy":"BY_VALUE","code":"res","typeFullName":"","columnNumber":35,"order":2,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":22,"order":1,"depthFirstOrder":-14,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500},{"internalFlags":4,"code":"query","columnNumber":22,"order":2,"depthFirstOrder":-13,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-12,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"internalFlags":4,"code":"url","columnNumber":22,"order":2,"depthFirstOrder":-11,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"url","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.url","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-10,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"url = encodeURI(req.query.url)","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-8,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-7,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500},{"internalFlags":4,"code":"redirect","columnNumber":2,"order":2,"depthFirstOrder":-6,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"redirect","lineNumber":20,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.redirect","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-5,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":20,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""}],"branchPoints":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[],"id":4355481239626406000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p0","evaluationStrategy":"BY_VALUE","code":"p0","typeFullName":"ANY","order":0,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":20,"id":1793433451611456500}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[{"id":4355481239626404000,"name":"DESCRIPTOR","value":"http","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpResponse"],"name":"res","evaluationStrategy":"BY_VALUE","code":"res","typeFullName":"","columnNumber":35,"order":2,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":20,"id":1793433451611456500}},{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p0","evaluationStrategy":"BY_VALUE","code":"p0","typeFullName":"ANY","order":0,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700}}],"id":4355481239626406000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[],"id":4355481239626406000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p0","evaluationStrategy":"BY_VALUE","code":"p0","typeFullName":"ANY","order":0,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":20,"id":1793433451611456500}},"id":4355481239626406000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"open-redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Open redirect: HTTP Request parameters are used in HTTP redirects via `res` in `anonymous1`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"3.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"A1-injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP request parameters are used in a HTTP redirect without validation.\n Using a specially crafted URL, an attacker could launch phishing attacks and steal user credentials.\n ## Countermeasures\n - Ensure data passed in HTTP requests does not control their final destination.\n ## Additional information\n **[CWE-601](https://cwe.mitre.org/data/definitions/601.html)**\n **[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"[CWE-601](https://cwe.mitre.org/data/definitions/601.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://cwe.mitre.org/data/definitions/601.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Open Redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/redirect.js::program:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^express.Response^.redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"7db313dd0991e62520a361fa03669d68","source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"DESCRIPTOR","value":"http","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpResponse"],"name":"res","evaluationStrategy":"BY_VALUE","code":"res","typeFullName":"","columnNumber":36,"order":2,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"DESCRIPTOR","value":"http","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpResponse"],"name":"res","evaluationStrategy":"BY_VALUE","code":"res","typeFullName":"","columnNumber":36,"order":2,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":19,"order":1,"depthFirstOrder":-30,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500},{"internalFlags":4,"code":"query","columnNumber":19,"order":2,"depthFirstOrder":-29,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":19,"order":1,"depthFirstOrder":-28,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"internalFlags":4,"code":"path","columnNumber":19,"order":2,"depthFirstOrder":-27,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"path","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.path","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"followPath = req.query.path","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-25,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-24,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-23,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":1793433451611456500},{"internalFlags":4,"code":"session","columnNumber":6,"order":2,"depthFirstOrder":-22,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"session","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.session","typeFullName":"","columnNumber":6,"order":2,"depthFirstOrder":-21,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"(_tmp_0 = req.session)","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-20,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"internalFlags":4,"code":"isAuthenticated","columnNumber":6,"order":2,"depthFirstOrder":-19,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"isAuthenticated","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"(_tmp_0 = req.session).isAuthenticated","typeFullName":"","columnNumber":6,"order":0,"depthFirstOrder":-18,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":11,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-16,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":12,"id":1793433451611456500},{"internalFlags":4,"code":"redirect","columnNumber":4,"order":2,"depthFirstOrder":-8,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"redirect","lineNumber":12,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.redirect","typeFullName":"","columnNumber":4,"order":0,"depthFirstOrder":-7,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\"http://example.com/\"","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-5,"_label":"LITERAL","argumentIndex":1,"lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":41,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":12,"id":1793433451611456500},{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""}],"branchPoints":[{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-16,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500}],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[],"id":4355481239626406000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p0","evaluationStrategy":"BY_VALUE","code":"p0","typeFullName":"ANY","order":0,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":12,"id":1793433451611456500}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[{"id":4355481239626404000,"name":"DESCRIPTOR","value":"http","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpResponse"],"name":"res","evaluationStrategy":"BY_VALUE","code":"res","typeFullName":"","columnNumber":36,"order":2,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":12,"id":1793433451611456500}},{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p0","evaluationStrategy":"BY_VALUE","code":"p0","typeFullName":"ANY","order":0,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700}}],"id":4355481239626406000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[],"id":4355481239626406000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p0","evaluationStrategy":"BY_VALUE","code":"p0","typeFullName":"ANY","order":0,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":12,"id":1793433451611456500}},"id":4355481239626406000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"open-redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Open redirect: HTTP Request parameters are used in HTTP redirects via `res` in `anonymous`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"3.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"A1-injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP request parameters are used in a HTTP redirect without validation.\n Using a specially crafted URL, an attacker could launch phishing attacks and steal user credentials.\n ## Countermeasures\n - Ensure data passed in HTTP requests does not control their final destination.\n ## Additional information\n **[CWE-601](https://cwe.mitre.org/data/definitions/601.html)**\n **[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"[CWE-601](https://cwe.mitre.org/data/definitions/601.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://cwe.mitre.org/data/definitions/601.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Open Redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/redirect.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^express.Response^.redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"7480f5134a477adc0aa1a06679b66f5b","source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":30,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":30,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":22,"order":1,"depthFirstOrder":-14,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500},{"internalFlags":4,"code":"query","columnNumber":22,"order":2,"depthFirstOrder":-13,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-12,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"internalFlags":4,"code":"url","columnNumber":22,"order":2,"depthFirstOrder":-11,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"url","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.url","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-10,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"encodeURI","astParentFullName":"<global>","fullName":"encodeURI","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398700,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626398700},{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"url = encodeURI(req.query.url)","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-8,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"url = encodeURI(req.query.url)","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-8,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-7,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500},{"internalFlags":4,"code":"redirect","columnNumber":2,"order":2,"depthFirstOrder":-6,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"redirect","lineNumber":20,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.redirect","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-5,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":20,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""}],"branchPoints":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626406000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":30,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.url","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-10,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500}},{"method":{"name":"encodeURI","astParentFullName":"<global>","fullName":"encodeURI","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"+encoded","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_TRANSFORM","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"encode","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626398700}},{"method":{"name":"encodeURI","astParentFullName":"<global>","fullName":"encodeURI","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"+encoded","_label":"TAG"},{"id":4355481239626403300,"name":"FROM_OUTSIDE","value":"","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_TRANSFORM","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"encode","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626398700}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500}},{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700}}],"id":4355481239626406000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626406000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500}},"id":4355481239626406000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"open-redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Open redirect: HTTP Request parameters are used in HTTP redirects via `req` in `anonymous1`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"3.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"A1-injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP request parameters are used in a HTTP redirect without validation.\n Using a specially crafted URL, an attacker could launch phishing attacks and steal user credentials.\n ## Countermeasures\n - Ensure data passed in HTTP requests does not control their final destination.\n ## Additional information\n **[CWE-601](https://cwe.mitre.org/data/definitions/601.html)**\n **[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"[CWE-601](https://cwe.mitre.org/data/definitions/601.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://cwe.mitre.org/data/definitions/601.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Open Redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/redirect.js::program:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^express.Response^.redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"206e71a7ef8ee4f34a4486741e5daaa7","source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":31,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":31,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":19,"order":1,"depthFirstOrder":-30,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500},{"internalFlags":4,"code":"query","columnNumber":19,"order":2,"depthFirstOrder":-29,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":19,"order":1,"depthFirstOrder":-28,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"internalFlags":4,"code":"path","columnNumber":19,"order":2,"depthFirstOrder":-27,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"path","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.path","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"followPath = req.query.path","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-25,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"followPath = req.query.path","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-25,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-24,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-23,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":1793433451611456500},{"internalFlags":4,"code":"session","columnNumber":6,"order":2,"depthFirstOrder":-22,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"session","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.session","typeFullName":"","columnNumber":6,"order":2,"depthFirstOrder":-21,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"(_tmp_0 = req.session)","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-20,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"internalFlags":4,"code":"isAuthenticated","columnNumber":6,"order":2,"depthFirstOrder":-19,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"isAuthenticated","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"(_tmp_0 = req.session).isAuthenticated","typeFullName":"","columnNumber":6,"order":0,"depthFirstOrder":-18,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":11,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-16,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":12,"id":1793433451611456500},{"internalFlags":4,"code":"redirect","columnNumber":4,"order":2,"depthFirstOrder":-8,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"redirect","lineNumber":12,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.redirect","typeFullName":"","columnNumber":4,"order":0,"depthFirstOrder":-7,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\"http://example.com/\"","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-5,"_label":"LITERAL","argumentIndex":1,"lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":41,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":12,"id":1793433451611456500},{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""}],"branchPoints":[{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-16,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500}],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626406000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":31,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.path","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":41,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":12,"id":1793433451611456500}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500}},{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700}}],"id":4355481239626406000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626406000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500}},"id":4355481239626406000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"open-redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Open redirect: HTTP Request parameters are used in HTTP redirects via `req` in `anonymous`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"3.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"A1-injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"HTTP request parameters are used in a HTTP redirect without validation.\n Using a specially crafted URL, an attacker could launch phishing attacks and steal user credentials.\n ## Countermeasures\n - Ensure data passed in HTTP requests does not control their final destination.\n ## Additional information\n **[CWE-601](https://cwe.mitre.org/data/definitions/601.html)**\n **[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"[CWE-601](https://cwe.mitre.org/data/definitions/601.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://cwe.mitre.org/data/definitions/601.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Open Redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/redirect.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^express.Response^.redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626404000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"e98fe771e2c404901cebb5f77001c21e","source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sourceType":"EXPOSED_PARAM","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":51,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":91,"id":3843071682023407000},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sourceType":"EXPOSED_PARAM","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":51,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":91,"id":3843071682023407000},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},{"dynamicTypeHintFullName":[],"name":"userConfig","internalFlags":4,"code":"userConfig","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-24,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":92,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":19,"order":1,"depthFirstOrder":-23,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":92,"id":3843071682023407000},{"internalFlags":4,"code":"params","columnNumber":19,"order":2,"depthFirstOrder":-22,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"params","lineNumber":92,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.params","typeFullName":"","columnNumber":19,"order":1,"depthFirstOrder":-21,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":92,"id":3843071682023407000},{"internalFlags":4,"code":"userConfig","columnNumber":19,"order":2,"depthFirstOrder":-20,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"userConfig","lineNumber":92,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.params.userConfig","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-19,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":92,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"userConfig = req.params.userConfig","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-18,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":92,"id":3843071682023407000},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"userConfig = req.params.userConfig","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-18,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":92,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":93,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_tmp_3","internalFlags":4,"code":"_tmp_3","typeFullName":"ANY","columnNumber":15,"order":1,"depthFirstOrder":-16,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":93,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"config = {}","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-15,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":93,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"merge","internalFlags":4,"code":"merge","typeFullName":"ANY","columnNumber":2,"order":0,"depthFirstOrder":-14,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":94,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"this","internalFlags":4,"code":"this","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-13,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":94,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":8,"order":2,"depthFirstOrder":-12,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":94,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"userConfig","internalFlags":4,"code":"userConfig","typeFullName":"ANY","columnNumber":16,"order":3,"depthFirstOrder":-11,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":94,"id":3843071682023407000},{"name":"","internalFlags":4,"code":"merge(config, userConfig)","typeFullName":"","columnNumber":2,"order":3,"depthFirstOrder":-10,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":94,"id":3843071682023407000},{"name":"merge","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:merge","signature":"","astParentType":"","internalFlags":4,"columnNumber":12,"depthFirstOrder":-64,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:merge","isExternal":false,"lineNumber":33,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},{"dynamicTypeHintFullName":[],"name":"_iterator_1","internalFlags":4,"code":"_iterator_1","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-63,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"source","internalFlags":4,"code":"source","typeFullName":"ANY","columnNumber":19,"order":1,"depthFirstOrder":-62,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":34,"id":3843071682023407000},{"name":"keys","internalFlags":4,"code":"Object.keys(source)","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-61,"methodFullName":"Object.keys","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"name":"Object.keys","astParentFullName":"<global>","fullName":"Object.keys","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"keys","internalFlags":4,"code":"Object.keys(source)","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-61,"methodFullName":"Object.keys","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"Symbol","internalFlags":4,"code":"Symbol","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-60,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":34,"id":3843071682023407000},{"internalFlags":4,"code":"iterator","columnNumber":2,"order":2,"depthFirstOrder":-59,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"iterator","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"Symbol.iterator","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-58,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.indexAccess","internalFlags":4,"code":"Object.keys(source)[Symbol.iterator]","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-57,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"this","internalFlags":4,"code":"this","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-56,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":34,"id":3843071682023407000},{"name":"","internalFlags":4,"code":"Object.keys(source)[Symbol.iterator]()","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-55,"methodFullName":"","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"_iterator_1 = Object.keys(source)[Symbol.iterator]()","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-54,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_result_1","internalFlags":4,"code":"_result_1","typeFullName":"ANY","columnNumber":2,"order":2,"depthFirstOrder":-53,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"attr","internalFlags":4,"code":"attr","typeFullName":"ANY","columnNumber":2,"order":3,"depthFirstOrder":-52,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_result_1","internalFlags":6,"code":"_result_1","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-51,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_iterator_1","internalFlags":4,"code":"_iterator_1","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-50,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":34,"id":3843071682023407000},{"internalFlags":4,"code":"next","columnNumber":2,"order":2,"depthFirstOrder":-49,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"next","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_iterator_1.next","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-48,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_iterator_1","internalFlags":4,"code":"_iterator_1","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-47,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":34,"id":3843071682023407000},{"name":"","internalFlags":4,"code":"_iterator_1.next()","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-46,"methodFullName":"","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"(_result_1 = _iterator_1.next())","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-45,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"internalFlags":4,"code":"done","columnNumber":2,"order":2,"depthFirstOrder":-44,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"done","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"(_result_1 = _iterator_1.next()).done","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-43,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.not","internalFlags":4,"code":"!(_result_1 = _iterator_1.next()).done","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-42,"methodFullName":"<operator>.not","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"attr","internalFlags":8,"code":"attr","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-38,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_result_1","internalFlags":0,"code":"_result_1","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-37,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":34,"id":3843071682023407000},{"internalFlags":0,"code":"value","columnNumber":2,"order":2,"depthFirstOrder":-36,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"value","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":0,"code":"_result_1.value","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-35,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":0,"code":"attr = _result_1.value","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-34,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_typeof","internalFlags":0,"code":"_typeof","typeFullName":"ANY","columnNumber":8,"order":0,"depthFirstOrder":-33,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"this","internalFlags":0,"code":"this","typeFullName":"ANY","columnNumber":8,"order":1,"depthFirstOrder":-32,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"target","internalFlags":0,"code":"target","typeFullName":"ANY","columnNumber":16,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"attr","internalFlags":0,"code":"attr","typeFullName":"ANY","columnNumber":23,"order":2,"depthFirstOrder":-30,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":35,"id":3843071682023407000},{"name":"<operator>.indexAccess","internalFlags":0,"code":"target[attr]","typeFullName":"","columnNumber":16,"order":2,"depthFirstOrder":-29,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":35,"id":3843071682023407000},{"name":"","internalFlags":0,"code":"_typeof(target[attr])","typeFullName":"","columnNumber":8,"order":1,"depthFirstOrder":-28,"methodFullName":"","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":0,"code":"\"object\"","typeFullName":"ANY","columnNumber":34,"order":2,"depthFirstOrder":-27,"_label":"LITERAL","argumentIndex":2,"lineNumber":35,"id":3843071682023407000},{"name":"<operator>.equals","internalFlags":0,"code":"_typeof(target[attr]) === \"object\"","typeFullName":"","columnNumber":8,"order":1,"depthFirstOrder":-26,"methodFullName":"<operator>.equals","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_typeof","internalFlags":0,"code":"_typeof","typeFullName":"ANY","columnNumber":46,"order":0,"depthFirstOrder":-25,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"this","internalFlags":0,"code":"this","typeFullName":"ANY","columnNumber":46,"order":1,"depthFirstOrder":-24,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"source","internalFlags":0,"code":"source","typeFullName":"ANY","columnNumber":54,"order":1,"depthFirstOrder":-23,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"attr","internalFlags":0,"code":"attr","typeFullName":"ANY","columnNumber":61,"order":2,"depthFirstOrder":-22,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":35,"id":3843071682023407000},{"name":"<operator>.indexAccess","internalFlags":0,"code":"source[attr]","typeFullName":"","columnNumber":54,"order":2,"depthFirstOrder":-21,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":35,"id":3843071682023407000},{"name":"","internalFlags":0,"code":"_typeof(source[attr])","typeFullName":"","columnNumber":46,"order":1,"depthFirstOrder":-20,"methodFullName":"","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":35,"id":3843071682023407000},{"name":"_typeof","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:_typeof:_typeof","signature":"","astParentType":"","internalFlags":4,"columnNumber":136,"depthFirstOrder":-5,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:_typeof:_typeof","isExternal":false,"lineNumber":3,"id":3843071682023406600,"order":0,"filename":"vulnerabilities/dep-lodash.js"},{"dynamicTypeHintFullName":[],"name":"obj","internalFlags":4,"code":"obj","typeFullName":"ANY","columnNumber":174,"order":1,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":3,"id":3843071682023406600},{"name":"<operator>.instanceOf","internalFlags":4,"code":"typeof obj","typeFullName":"","columnNumber":167,"order":1,"depthFirstOrder":-3,"methodFullName":"<operator>.instanceOf","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":3,"id":3843071682023406600},{"name":"<operator>.instanceOf","astParentFullName":"<global>","fullName":"<operator>.instanceOf","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.instanceOf","internalFlags":4,"code":"typeof obj","typeFullName":"","columnNumber":167,"order":1,"depthFirstOrder":-3,"methodFullName":"<operator>.instanceOf","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":3,"id":3843071682023406600},{"internalFlags":4,"code":"return typeof obj","columnNumber":160,"order":1,"depthFirstOrder":-2,"_label":"RETURN","argumentIndex":-1,"lineNumber":3,"id":3843071682023406600},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","columnNumber":136,"order":2,"depthFirstOrder":-1,"_label":"METHOD_RETURN","lineNumber":3,"id":3843071682023406600},{"name":"","internalFlags":0,"code":"_typeof(source[attr])","typeFullName":"","columnNumber":46,"order":1,"depthFirstOrder":-20,"methodFullName":"","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":0,"code":"\"object\"","typeFullName":"ANY","columnNumber":72,"order":2,"depthFirstOrder":-19,"_label":"LITERAL","argumentIndex":2,"lineNumber":35,"id":3843071682023407000},{"name":"<operator>.equals","internalFlags":0,"code":"_typeof(source[attr]) === \"object\"","typeFullName":"","columnNumber":46,"order":2,"depthFirstOrder":-18,"methodFullName":"<operator>.equals","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":35,"id":3843071682023407000},{"name":"<operator>.logicalAnd","internalFlags":0,"code":"_typeof(target[attr]) === \"object\" && _typeof(source[attr]) === \"object\"","typeFullName":"","columnNumber":8,"order":1,"depthFirstOrder":-17,"methodFullName":"<operator>.logicalAnd","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":35,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"target","internalFlags":0,"code":"target","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-16,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":38,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"attr","internalFlags":0,"code":"attr","typeFullName":"ANY","columnNumber":13,"order":2,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":38,"id":3843071682023407000},{"name":"<operator>.indexAccess","internalFlags":0,"code":"target[attr]","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-14,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":38,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"source","internalFlags":0,"code":"source","typeFullName":"ANY","columnNumber":21,"order":1,"depthFirstOrder":-13,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":38,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"attr","internalFlags":0,"code":"attr","typeFullName":"ANY","columnNumber":28,"order":2,"depthFirstOrder":-12,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":38,"id":3843071682023407000},{"name":"<operator>.indexAccess","internalFlags":0,"code":"source[attr]","typeFullName":"","columnNumber":21,"order":2,"depthFirstOrder":-11,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":38,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":1,"code":"target[attr] = source[attr]","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-10,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":38,"id":3843071682023407000},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":1,"code":"target[attr] = source[attr]","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-10,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":38,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_result_1","internalFlags":6,"code":"_result_1","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-51,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_iterator_1","internalFlags":4,"code":"_iterator_1","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-50,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":34,"id":3843071682023407000},{"internalFlags":4,"code":"next","columnNumber":2,"order":2,"depthFirstOrder":-49,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"next","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"_iterator_1.next","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-48,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_iterator_1","internalFlags":4,"code":"_iterator_1","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-47,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":34,"id":3843071682023407000},{"name":"","internalFlags":4,"code":"_iterator_1.next()","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-46,"methodFullName":"","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"(_result_1 = _iterator_1.next())","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-45,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"internalFlags":4,"code":"done","columnNumber":2,"order":2,"depthFirstOrder":-44,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"done","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"(_result_1 = _iterator_1.next()).done","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-43,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"name":"<operator>.not","internalFlags":4,"code":"!(_result_1 = _iterator_1.next()).done","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-42,"methodFullName":"<operator>.not","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":34,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"target","internalFlags":4,"code":"target","typeFullName":"ANY","columnNumber":9,"order":1,"depthFirstOrder":-41,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":42,"id":3843071682023407000},{"internalFlags":4,"code":"return target","columnNumber":2,"order":2,"depthFirstOrder":-40,"_label":"RETURN","argumentIndex":-1,"lineNumber":42,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","columnNumber":12,"order":2,"depthFirstOrder":-39,"_label":"METHOD_RETURN","lineNumber":33,"id":3843071682023407000},{"name":"","internalFlags":4,"code":"merge(config, userConfig)","typeFullName":"","columnNumber":2,"order":3,"depthFirstOrder":-10,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":94,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":95,"id":3843071682023407000},{"internalFlags":4,"code":"send","columnNumber":2,"order":2,"depthFirstOrder":-8,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"send","lineNumber":95,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.send","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-7,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":95,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":95,"id":3843071682023407000},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\"Config is\"","typeFullName":"ANY","columnNumber":11,"order":1,"depthFirstOrder":-5,"_label":"LITERAL","argumentIndex":1,"lineNumber":95,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":25,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":95,"id":3843071682023407000},{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":95,"id":3843071682023407000},{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":95,"id":3843071682023407000}],"branchPoints":[],"sink":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":95,"id":3843071682023407000}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":51,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":91,"id":3843071682023407000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.params.userConfig","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-19,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":92,"id":3843071682023407000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"userConfig","internalFlags":4,"code":"userConfig","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-24,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":92,"id":3843071682023407000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"userConfig","internalFlags":4,"code":"userConfig","typeFullName":"ANY","columnNumber":16,"order":3,"depthFirstOrder":-11,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":94,"id":3843071682023407000}},{"method":{"name":"merge","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:merge","signature":"","astParentType":"","internalFlags":4,"columnNumber":12,"depthFirstOrder":-64,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:merge","isExternal":false,"lineNumber":33,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"source","evaluationStrategy":"BY_VALUE","code":"source","typeFullName":"","columnNumber":35,"order":2,"_label":"METHOD_PARAMETER_IN","lineNumber":33,"id":3843071682023407000}},{"method":{"name":"merge","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:merge","signature":"","astParentType":"","internalFlags":4,"columnNumber":12,"depthFirstOrder":-64,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:merge","isExternal":false,"lineNumber":33,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.indexAccess","internalFlags":0,"code":"source[attr]","typeFullName":"","columnNumber":21,"order":2,"depthFirstOrder":-11,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":38,"id":3843071682023407000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"merge","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:merge","signature":"","astParentType":"","internalFlags":4,"columnNumber":12,"depthFirstOrder":-64,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:merge","isExternal":false,"lineNumber":33,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.indexAccess","internalFlags":0,"code":"target[attr]","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-14,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":38,"id":3843071682023407000}},{"method":{"name":"merge","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:merge","signature":"","astParentType":"","internalFlags":4,"columnNumber":12,"depthFirstOrder":-64,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:merge","isExternal":false,"lineNumber":33,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"target","evaluationStrategy":"BY_VALUE","code":"target","typeFullName":"","columnNumber":27,"order":1,"_label":"METHOD_PARAMETER_OUT","lineNumber":33,"id":4355481239626400300}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":8,"order":2,"depthFirstOrder":-12,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":94,"id":3843071682023407000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":25,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":95,"id":3843071682023407000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":95,"id":3843071682023407000}}],"id":4355481239626404000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":41,"depthFirstOrder":-25,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous","isExternal":false,"lineNumber":91,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":95,"id":3843071682023407000}},"id":4355481239626404000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626404000,"key":"name","value":"xss-to-html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"TitleTemplate","value":"XSS: HTTP data to HTML via `req` in `anonymous`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Score","value":"5.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Category","value":"A7-XSS","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"DescriptionTemplate","value":"HTTP request data is used in rendering HTML without validation.\n By sending a specially crafted request, an attacker could inject malicious code into the website and compromise the confidentiality and integrity of the data exchanged between the service and users.\n ## Countermeasures\n - Sanitize and validate HTTP data before passing it back to the user.\n ## Additional information\n **[CWE-79](https://cwe.mitre.org/data/definitions/79.html)**\n **[OWASP-A7](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS))**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"cwelink","value":"[CWE-79](https://cwe.mitre.org/data/definitions/79.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"owasplink","value":"[OWASP-A7](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS))","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Link","value":"https://cwe.mitre.org/data/definitions/79.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"VulnerabilityDescription","value":"XSS","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"source_method","value":"vulnerabilities/dep-lodash.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"sink_method","value":"vulnerabilities/dep-lodash.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626404000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"7e5b64e304d0cac9c7e08249bee923bb","source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"sourceType":"EXPOSED_PARAM","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":34,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":6,"id":1281023894008469000},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"sourceType":"EXPOSED_PARAM","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":34,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":6,"id":1281023894008469000},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},{"dynamicTypeHintFullName":[],"name":"name","internalFlags":4,"code":"name","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-18,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":7,"id":1281023894008469000},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":13,"order":1,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":7,"id":1281023894008469000},{"internalFlags":4,"code":"query","columnNumber":13,"order":2,"depthFirstOrder":-16,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":7,"id":1281023894008469000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":13,"order":1,"depthFirstOrder":-15,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":1281023894008469000},{"internalFlags":4,"code":"name","columnNumber":13,"order":2,"depthFirstOrder":-14,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"name","lineNumber":7,"id":1281023894008469000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.name","typeFullName":"","columnNumber":13,"order":2,"depthFirstOrder":-13,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":1281023894008469000},{"name":"<operator>.assignment","internalFlags":4,"code":"name = req.query.name","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-12,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":1281023894008469000},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"name = req.query.name","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-12,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":1281023894008469000},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-11,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":8,"id":1281023894008469000},{"internalFlags":4,"code":"send","columnNumber":2,"order":2,"depthFirstOrder":-10,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"send","lineNumber":8,"id":1281023894008469000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.send","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-9,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":1281023894008469000},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-8,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":8,"id":1281023894008469000},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\"<h1> Hello :\"","typeFullName":"ANY","columnNumber":11,"order":1,"depthFirstOrder":-7,"_label":"LITERAL","argumentIndex":1,"lineNumber":8,"id":1281023894008469000},{"dynamicTypeHintFullName":[],"name":"name","internalFlags":4,"code":"name","typeFullName":"ANY","columnNumber":28,"order":2,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":8,"id":1281023894008469000},{"name":"<operator>.addition","internalFlags":4,"code":"\"<h1> Hello :\" + name","typeFullName":"","columnNumber":11,"order":1,"depthFirstOrder":-5,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":1281023894008469000},{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.addition","internalFlags":4,"code":"\"<h1> Hello :\" + name","typeFullName":"","columnNumber":11,"order":1,"depthFirstOrder":-5,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":1281023894008469000},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\"</h1>\"","typeFullName":"ANY","columnNumber":35,"order":2,"depthFirstOrder":-4,"_label":"LITERAL","argumentIndex":2,"lineNumber":8,"id":1281023894008469000},{"name":"<operator>.addition","internalFlags":4,"code":"\"<h1> Hello :\" + name + \"</h1>\"","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":1281023894008469000},{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.addition","internalFlags":4,"code":"\"<h1> Hello :\" + name + \"</h1>\"","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":1281023894008469000}],"branchPoints":[],"sink":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"<operator>.addition","internalFlags":4,"code":"\"<h1> Hello :\" + name + \"</h1>\"","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":1281023894008469000}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":34,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":6,"id":1281023894008469000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.name","typeFullName":"","columnNumber":13,"order":2,"depthFirstOrder":-13,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":1281023894008469000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"name","internalFlags":4,"code":"name","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-18,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":7,"id":1281023894008469000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"name","internalFlags":4,"code":"name","typeFullName":"ANY","columnNumber":28,"order":2,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":8,"id":1281023894008469000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.addition","internalFlags":4,"code":"\"<h1> Hello :\" + name","typeFullName":"","columnNumber":11,"order":1,"depthFirstOrder":-5,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":1281023894008469000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.addition","internalFlags":4,"code":"\"<h1> Hello :\" + name + \"</h1>\"","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":1281023894008469000}}],"id":4355481239626404000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/xss.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-19,"_label":"METHOD","code":"vulnerabilities/xss.js::program:anonymous","isExternal":false,"lineNumber":6,"id":1281023894008469000,"order":0,"filename":"vulnerabilities/xss.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"<operator>.addition","internalFlags":4,"code":"\"<h1> Hello :\" + name + \"</h1>\"","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":1281023894008469000}},"id":4355481239626404000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626404000,"key":"name","value":"xss-to-html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"TitleTemplate","value":"XSS: HTTP data to HTML via `req` in `anonymous`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Score","value":"5.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Category","value":"A7-XSS","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"DescriptionTemplate","value":"HTTP request data is used in rendering HTML without validation.\n By sending a specially crafted request, an attacker could inject malicious code into the website and compromise the confidentiality and integrity of the data exchanged between the service and users.\n ## Countermeasures\n - Sanitize and validate HTTP data before passing it back to the user.\n ## Additional information\n **[CWE-79](https://cwe.mitre.org/data/definitions/79.html)**\n **[OWASP-A7](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS))**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"cwelink","value":"[CWE-79](https://cwe.mitre.org/data/definitions/79.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"owasplink","value":"[OWASP-A7](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS))","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Link","value":"https://cwe.mitre.org/data/definitions/79.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"VulnerabilityDescription","value":"XSS","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"source_method","value":"vulnerabilities/xss.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"sink_method","value":"vulnerabilities/xss.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626404000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"590e52ecab1cf38096bba5a672233854","source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sourceType":"EXPOSED_PARAM","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":61,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":97,"id":3843071682023407000},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sourceType":"EXPOSED_PARAM","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":61,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":97,"id":3843071682023407000},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},{"dynamicTypeHintFullName":[],"name":"userConfig","internalFlags":4,"code":"userConfig","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-29,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":98,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":19,"order":1,"depthFirstOrder":-28,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":98,"id":3843071682023407000},{"internalFlags":4,"code":"params","columnNumber":19,"order":2,"depthFirstOrder":-27,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"params","lineNumber":98,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.params","typeFullName":"","columnNumber":19,"order":1,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":98,"id":3843071682023407000},{"internalFlags":4,"code":"userConfig","columnNumber":19,"order":2,"depthFirstOrder":-25,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"userConfig","lineNumber":98,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.params.userConfig","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-24,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":98,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"userConfig = req.params.userConfig","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-23,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":98,"id":3843071682023407000},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"userConfig = req.params.userConfig","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-23,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":98,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-22,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":99,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"_tmp_4","internalFlags":4,"code":"_tmp_4","typeFullName":"ANY","columnNumber":15,"order":1,"depthFirstOrder":-21,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":99,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"config = {}","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-20,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":99,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"pathAssignment","internalFlags":4,"code":"pathAssignment","typeFullName":"ANY","columnNumber":2,"order":0,"depthFirstOrder":-19,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":100,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"this","internalFlags":4,"code":"this","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-18,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":100,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":17,"order":2,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":100,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":25,"order":1,"depthFirstOrder":-16,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":100,"id":3843071682023407000},{"internalFlags":4,"code":"params","columnNumber":25,"order":2,"depthFirstOrder":-15,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"params","lineNumber":100,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.params","typeFullName":"","columnNumber":25,"order":1,"depthFirstOrder":-14,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":100,"id":3843071682023407000},{"internalFlags":4,"code":"userPath","columnNumber":25,"order":2,"depthFirstOrder":-13,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"userPath","lineNumber":100,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.params.userPath","typeFullName":"","columnNumber":25,"order":3,"depthFirstOrder":-12,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":100,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"userConfig","internalFlags":4,"code":"userConfig","typeFullName":"ANY","columnNumber":46,"order":4,"depthFirstOrder":-11,"_label":"IDENTIFIER","argumentIndex":3,"lineNumber":100,"id":3843071682023407000},{"name":"","internalFlags":4,"code":"pathAssignment(config, req.params.userPath, userConfig)","typeFullName":"","columnNumber":2,"order":3,"depthFirstOrder":-10,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":100,"id":3843071682023407000},{"name":"pathAssignment","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:pathAssignment","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-66,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:pathAssignment","isExternal":false,"lineNumber":45,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},{"dynamicTypeHintFullName":[],"name":"segments","internalFlags":4,"code":"segments","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-65,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":46,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"path","internalFlags":4,"code":"path","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-64,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":46,"id":3843071682023407000},{"internalFlags":4,"code":"split","columnNumber":17,"order":2,"depthFirstOrder":-63,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"split","lineNumber":46,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"path.split","typeFullName":"","columnNumber":17,"order":0,"depthFirstOrder":-62,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":46,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"path","internalFlags":4,"code":"path","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-61,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":46,"id":3843071682023407000},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\".\"","typeFullName":"ANY","columnNumber":28,"order":2,"depthFirstOrder":-60,"_label":"LITERAL","argumentIndex":1,"lineNumber":46,"id":3843071682023407000},{"name":"","internalFlags":4,"code":"path.split(\".\")","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-59,"methodFullName":"","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":46,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"segments = path.split(\".\")","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-58,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":46,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"key","internalFlags":4,"code":"key","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-57,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":47,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"segments","internalFlags":4,"code":"segments","typeFullName":"ANY","columnNumber":12,"order":1,"depthFirstOrder":-56,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":47,"id":3843071682023407000},{"internalFlags":4,"code":"splice","columnNumber":12,"order":2,"depthFirstOrder":-55,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"splice","lineNumber":47,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"segments.splice","typeFullName":"","columnNumber":12,"order":0,"depthFirstOrder":-54,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":47,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"segments","internalFlags":4,"code":"segments","typeFullName":"ANY","columnNumber":12,"order":1,"depthFirstOrder":-53,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":47,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"internalFlags":4,"code":"0","typeFullName":"ANY","columnNumber":28,"order":2,"depthFirstOrder":-52,"_label":"LITERAL","argumentIndex":1,"lineNumber":47,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"internalFlags":4,"code":"1","typeFullName":"ANY","columnNumber":31,"order":3,"depthFirstOrder":-51,"_label":"LITERAL","argumentIndex":2,"lineNumber":47,"id":3843071682023407000},{"name":"","internalFlags":4,"code":"segments.splice(0, 1)","typeFullName":"","columnNumber":12,"order":1,"depthFirstOrder":-50,"methodFullName":"","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":47,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"internalFlags":4,"code":"0","typeFullName":"ANY","columnNumber":34,"order":2,"depthFirstOrder":-49,"_label":"LITERAL","argumentIndex":2,"lineNumber":47,"id":3843071682023407000},{"name":"<operator>.indexAccess","internalFlags":4,"code":"segments.splice(0, 1)[0]","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-48,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":47,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"key = segments.splice(0, 1)[0]","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-47,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":47,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"segments","internalFlags":4,"code":"segments","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-46,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":49,"id":3843071682023407000},{"internalFlags":4,"code":"length","columnNumber":6,"order":2,"depthFirstOrder":-45,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"length","lineNumber":49,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"segments.length","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-44,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":49,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"obj","internalFlags":4,"code":"obj","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-43,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":56,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"key","internalFlags":4,"code":"key","typeFullName":"ANY","columnNumber":8,"order":2,"depthFirstOrder":-42,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":56,"id":3843071682023407000},{"name":"<operator>.indexAccess","internalFlags":4,"code":"obj[key]","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-41,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":56,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"value","internalFlags":4,"code":"value","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-40,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":56,"id":3843071682023407000},{"name":"<operator>.assignment","internalFlags":4,"code":"obj[key] = value","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-39,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":56,"id":3843071682023407000},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"obj[key] = value","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-39,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":56,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"obj","internalFlags":4,"code":"obj","typeFullName":"ANY","columnNumber":9,"order":1,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":59,"id":3843071682023407000},{"internalFlags":4,"code":"return obj","columnNumber":2,"order":4,"depthFirstOrder":-2,"_label":"RETURN","argumentIndex":-1,"lineNumber":59,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","columnNumber":21,"order":2,"depthFirstOrder":-1,"_label":"METHOD_RETURN","lineNumber":45,"id":3843071682023407000},{"name":"","internalFlags":4,"code":"pathAssignment(config, req.params.userPath, userConfig)","typeFullName":"","columnNumber":2,"order":3,"depthFirstOrder":-10,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":100,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":101,"id":3843071682023407000},{"internalFlags":4,"code":"send","columnNumber":2,"order":2,"depthFirstOrder":-8,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"send","lineNumber":101,"id":3843071682023407000},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.send","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-7,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":101,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":101,"id":3843071682023407000},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\"Config is\"","typeFullName":"ANY","columnNumber":11,"order":1,"depthFirstOrder":-5,"_label":"LITERAL","argumentIndex":1,"lineNumber":101,"id":3843071682023407000},{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":25,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":101,"id":3843071682023407000},{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":101,"id":3843071682023407000},{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":101,"id":3843071682023407000}],"branchPoints":[],"sink":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":101,"id":3843071682023407000}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":61,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":97,"id":3843071682023407000}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.params.userConfig","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-24,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":98,"id":3843071682023407000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"userConfig","internalFlags":4,"code":"userConfig","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-29,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":98,"id":3843071682023407000}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"userConfig","internalFlags":4,"code":"userConfig","typeFullName":"ANY","columnNumber":46,"order":4,"depthFirstOrder":-11,"_label":"IDENTIFIER","argumentIndex":3,"lineNumber":100,"id":3843071682023407000}},{"method":{"name":"pathAssignment","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:pathAssignment","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-66,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:pathAssignment","isExternal":false,"lineNumber":45,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"value","evaluationStrategy":"BY_VALUE","code":"value","typeFullName":"","columnNumber":56,"order":3,"_label":"METHOD_PARAMETER_IN","lineNumber":45,"id":3843071682023407000}},{"method":{"name":"pathAssignment","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:pathAssignment","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-66,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:pathAssignment","isExternal":false,"lineNumber":45,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"value","internalFlags":4,"code":"value","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-40,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":56,"id":3843071682023407000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"pathAssignment","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:pathAssignment","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-66,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:pathAssignment","isExternal":false,"lineNumber":45,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.indexAccess","internalFlags":4,"code":"obj[key]","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-41,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":56,"id":3843071682023407000}},{"method":{"name":"pathAssignment","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:pathAssignment","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-66,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:pathAssignment","isExternal":false,"lineNumber":45,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"obj","evaluationStrategy":"BY_VALUE","code":"obj","typeFullName":"","columnNumber":45,"order":1,"_label":"METHOD_PARAMETER_OUT","lineNumber":45,"id":4355481239626400300}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":17,"order":2,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":100,"id":3843071682023407000}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":25,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":101,"id":3843071682023407000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":101,"id":3843071682023407000}}],"id":4355481239626404000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":51,"depthFirstOrder":-30,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:anonymous1","isExternal":false,"lineNumber":97,"id":3843071682023407000,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"<operator>.addition","internalFlags":4,"code":"\"Config is\" + config","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":101,"id":3843071682023407000}},"id":4355481239626404000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626404000,"key":"name","value":"xss-to-html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"TitleTemplate","value":"XSS: HTTP data to HTML via `req` in `anonymous1`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Score","value":"5.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Category","value":"A7-XSS","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"DescriptionTemplate","value":"HTTP request data is used in rendering HTML without validation.\n By sending a specially crafted request, an attacker could inject malicious code into the website and compromise the confidentiality and integrity of the data exchanged between the service and users.\n ## Countermeasures\n - Sanitize and validate HTTP data before passing it back to the user.\n ## Additional information\n **[CWE-79](https://cwe.mitre.org/data/definitions/79.html)**\n **[OWASP-A7](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS))**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"cwelink","value":"[CWE-79](https://cwe.mitre.org/data/definitions/79.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"owasplink","value":"[OWASP-A7](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS))","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Link","value":"https://cwe.mitre.org/data/definitions/79.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"VulnerabilityDescription","value":"XSS","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"source_method","value":"vulnerabilities/dep-lodash.js::program:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"sink_method","value":"vulnerabilities/dep-lodash.js::program:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626404000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"da63d8771adf49165add45ea8fd3b9ef","source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"sourceType":"EXPOSED_PARAM","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":37,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":6,"id":4099276460824900600},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"sourceType":"EXPOSED_PARAM","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":37,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":6,"id":4099276460824900600},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},{"dynamicTypeHintFullName":[],"name":"obj","internalFlags":4,"code":"obj","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-40,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":7,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":12,"order":1,"depthFirstOrder":-39,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":7,"id":4099276460824900600},{"internalFlags":4,"code":"body","columnNumber":12,"order":2,"depthFirstOrder":-38,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"body","lineNumber":7,"id":4099276460824900600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.body","typeFullName":"","columnNumber":12,"order":1,"depthFirstOrder":-37,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":4099276460824900600},{"internalFlags":4,"code":"users","columnNumber":12,"order":2,"depthFirstOrder":-36,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"users","lineNumber":7,"id":4099276460824900600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.body.users","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-35,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":4099276460824900600},{"name":"<operator>.assignment","internalFlags":4,"code":"obj = req.body.users","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-34,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":4099276460824900600},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"obj = req.body.users","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-34,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"someArr","internalFlags":4,"code":"someArr","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-33,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":8,"id":4099276460824900600},{"name":"__ecma.Array.factory","internalFlags":4,"code":"__ecma.Array.factory()","typeFullName":"","columnNumber":16,"order":2,"depthFirstOrder":-32,"methodFullName":"__ecma.Array.factory","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":4099276460824900600},{"name":"<operator>.assignment","internalFlags":4,"code":"someArr = __ecma.Array.factory()","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-31,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":8,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"i","internalFlags":4,"code":"i","typeFullName":"ANY","columnNumber":11,"order":1,"depthFirstOrder":-30,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"internalFlags":4,"code":"0","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-29,"_label":"LITERAL","argumentIndex":2,"lineNumber":10,"id":4099276460824900600},{"name":"<operator>.assignment","internalFlags":4,"code":"i = 0","typeFullName":"","columnNumber":7,"order":3,"depthFirstOrder":-28,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":10,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"i","internalFlags":6,"code":"i","typeFullName":"ANY","columnNumber":18,"order":1,"depthFirstOrder":-27,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"obj","internalFlags":4,"code":"obj","typeFullName":"ANY","columnNumber":22,"order":1,"depthFirstOrder":-26,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":4099276460824900600},{"internalFlags":4,"code":"length","columnNumber":22,"order":2,"depthFirstOrder":-25,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"length","lineNumber":10,"id":4099276460824900600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"obj.length","typeFullName":"","columnNumber":22,"order":2,"depthFirstOrder":-24,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":10,"id":4099276460824900600},{"name":"<operator>.lessThan","internalFlags":4,"code":"i < obj.length","typeFullName":"","columnNumber":18,"order":2,"depthFirstOrder":-23,"methodFullName":"<operator>.lessThan","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":10,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"someArr","internalFlags":8,"code":"someArr","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-10,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":4099276460824900600},{"internalFlags":0,"code":"push","columnNumber":4,"order":2,"depthFirstOrder":-9,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"push","lineNumber":11,"id":4099276460824900600},{"name":"<operator>.fieldAccess","internalFlags":0,"code":"someArr.push","typeFullName":"","columnNumber":4,"order":0,"depthFirstOrder":-8,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"someArr","internalFlags":0,"code":"someArr","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-7,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":11,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"obj","internalFlags":0,"code":"obj","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"i","internalFlags":0,"code":"i","typeFullName":"ANY","columnNumber":21,"order":2,"depthFirstOrder":-5,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":11,"id":4099276460824900600},{"name":"<operator>.indexAccess","internalFlags":0,"code":"obj[i]","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-4,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":4099276460824900600},{"name":"","internalFlags":0,"code":"someArr.push(obj[i])","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-3,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":4099276460824900600},{"name":"^__ecma.Array^.push","astParentFullName":"<global>","fullName":"^__ecma.Array^.push","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394600,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394600},{"name":"","internalFlags":0,"code":"someArr.push(obj[i])","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-3,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"i","internalFlags":0,"code":"i","typeFullName":"ANY","columnNumber":34,"order":1,"depthFirstOrder":-2,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":4099276460824900600},{"name":"<operator>.postIncrement","internalFlags":1,"code":"i++","typeFullName":"","columnNumber":34,"order":3,"depthFirstOrder":-1,"methodFullName":"<operator>.postIncrement","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":10,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"i","internalFlags":6,"code":"i","typeFullName":"ANY","columnNumber":18,"order":1,"depthFirstOrder":-27,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"obj","internalFlags":4,"code":"obj","typeFullName":"ANY","columnNumber":22,"order":1,"depthFirstOrder":-26,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":10,"id":4099276460824900600},{"internalFlags":4,"code":"length","columnNumber":22,"order":2,"depthFirstOrder":-25,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"length","lineNumber":10,"id":4099276460824900600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"obj.length","typeFullName":"","columnNumber":22,"order":2,"depthFirstOrder":-24,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":10,"id":4099276460824900600},{"name":"<operator>.lessThan","internalFlags":4,"code":"i < obj.length","typeFullName":"","columnNumber":18,"order":2,"depthFirstOrder":-23,"methodFullName":"<operator>.lessThan","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":10,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-22,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":15,"id":4099276460824900600},{"internalFlags":4,"code":"send","columnNumber":2,"order":2,"depthFirstOrder":-21,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"send","lineNumber":15,"id":4099276460824900600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.send","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-20,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":15,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-19,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":15,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"someArr","internalFlags":4,"code":"someArr","typeFullName":"ANY","columnNumber":11,"order":1,"depthFirstOrder":-18,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":15,"id":4099276460824900600},{"internalFlags":4,"code":"join","columnNumber":11,"order":2,"depthFirstOrder":-17,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"join","lineNumber":15,"id":4099276460824900600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"someArr.join","typeFullName":"","columnNumber":11,"order":0,"depthFirstOrder":-16,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":15,"id":4099276460824900600},{"dynamicTypeHintFullName":[],"name":"someArr","internalFlags":4,"code":"someArr","typeFullName":"ANY","columnNumber":11,"order":1,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":15,"id":4099276460824900600},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\",\"","typeFullName":"ANY","columnNumber":24,"order":2,"depthFirstOrder":-14,"_label":"LITERAL","argumentIndex":1,"lineNumber":15,"id":4099276460824900600},{"name":"","internalFlags":4,"code":"someArr.join(\",\")","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-13,"methodFullName":"","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":4099276460824900600},{"name":"^__ecma.Array^.join","astParentFullName":"<global>","fullName":"^__ecma.Array^.join","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394600,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394600},{"name":"","internalFlags":4,"code":"someArr.join(\",\")","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-13,"methodFullName":"","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":4099276460824900600}],"branchPoints":[],"sink":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"","internalFlags":4,"code":"someArr.join(\",\")","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-13,"methodFullName":"","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":4099276460824900600}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":37,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":6,"id":4099276460824900600}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.body.users","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-35,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":7,"id":4099276460824900600}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"obj","internalFlags":4,"code":"obj","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-40,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":7,"id":4099276460824900600}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.indexAccess","internalFlags":0,"code":"obj[i]","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-4,"methodFullName":"<operator>.indexAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":4099276460824900600}},{"method":{"name":"^__ecma.Array^.push","astParentFullName":"<global>","fullName":"^__ecma.Array^.push","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394600,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626394600}},{"method":{"name":"^__ecma.Array^.push","astParentFullName":"<global>","fullName":"^__ecma.Array^.push","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394600,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p0","evaluationStrategy":"BY_VALUE","code":"p0","typeFullName":"ANY","order":0,"_label":"METHOD_PARAMETER_OUT","id":4355481239626401000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"someArr","internalFlags":0,"code":"someArr","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-7,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":11,"id":4099276460824900600}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"someArr","internalFlags":4,"code":"someArr","typeFullName":"ANY","columnNumber":11,"order":1,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":15,"id":4099276460824900600}},{"method":{"name":"^__ecma.Array^.join","astParentFullName":"<global>","fullName":"^__ecma.Array^.join","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394600,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p0","evaluationStrategy":"BY_VALUE","code":"p0","typeFullName":"ANY","order":0,"_label":"METHOD_PARAMETER_IN","id":4355481239626394600}},{"method":{"name":"^__ecma.Array^.join","astParentFullName":"<global>","fullName":"^__ecma.Array^.join","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394600,"order":0,"filename":""},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394600}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"","internalFlags":4,"code":"someArr.join(\",\")","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-13,"methodFullName":"","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":4099276460824900600}}],"id":4355481239626404000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/loop.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":27,"depthFirstOrder":-41,"_label":"METHOD","code":"vulnerabilities/loop.js::program:anonymous","isExternal":false,"lineNumber":6,"id":4099276460824900600,"order":0,"filename":"vulnerabilities/loop.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"","internalFlags":4,"code":"someArr.join(\",\")","typeFullName":"","columnNumber":11,"order":2,"depthFirstOrder":-13,"methodFullName":"","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":4099276460824900600}},"id":4355481239626404000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626404000,"key":"name","value":"xss-to-html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"TitleTemplate","value":"XSS: HTTP data to HTML via `req` in `anonymous`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Score","value":"5.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Category","value":"A7-XSS","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"DescriptionTemplate","value":"HTTP request data is used in rendering HTML without validation.\n By sending a specially crafted request, an attacker could inject malicious code into the website and compromise the confidentiality and integrity of the data exchanged between the service and users.\n ## Countermeasures\n - Sanitize and validate HTTP data before passing it back to the user.\n ## Additional information\n **[CWE-79](https://cwe.mitre.org/data/definitions/79.html)**\n **[OWASP-A7](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS))**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"cwelink","value":"[CWE-79](https://cwe.mitre.org/data/definitions/79.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"owasplink","value":"[OWASP-A7](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS))","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Link","value":"https://cwe.mitre.org/data/definitions/79.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"VulnerabilityDescription","value":"XSS","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"source_method","value":"vulnerabilities/loop.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"sink_method","value":"vulnerabilities/loop.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"f5792b094d2f5747b4d51e8225d093b1","source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":31,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":31,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":19,"order":1,"depthFirstOrder":-30,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500},{"internalFlags":4,"code":"query","columnNumber":19,"order":2,"depthFirstOrder":-29,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":19,"order":1,"depthFirstOrder":-28,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"internalFlags":4,"code":"path","columnNumber":19,"order":2,"depthFirstOrder":-27,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"path","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.path","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"followPath = req.query.path","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-25,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"followPath = req.query.path","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-25,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-24,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-23,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":11,"id":1793433451611456500},{"internalFlags":4,"code":"session","columnNumber":6,"order":2,"depthFirstOrder":-22,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"session","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.session","typeFullName":"","columnNumber":6,"order":2,"depthFirstOrder":-21,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"(_tmp_0 = req.session)","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-20,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"internalFlags":4,"code":"isAuthenticated","columnNumber":6,"order":2,"depthFirstOrder":-19,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"isAuthenticated","lineNumber":11,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"(_tmp_0 = req.session).isAuthenticated","typeFullName":"","columnNumber":6,"order":0,"depthFirstOrder":-18,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-17,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":11,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-16,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-9,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":12,"id":1793433451611456500},{"internalFlags":4,"code":"redirect","columnNumber":4,"order":2,"depthFirstOrder":-8,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"redirect","lineNumber":12,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.redirect","typeFullName":"","columnNumber":4,"order":0,"depthFirstOrder":-7,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":4,"order":1,"depthFirstOrder":-6,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":["__ecma.String"],"internalFlags":4,"code":"\"http://example.com/\"","typeFullName":"ANY","columnNumber":17,"order":1,"depthFirstOrder":-5,"_label":"LITERAL","argumentIndex":1,"lineNumber":12,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":41,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":12,"id":1793433451611456500},{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""}],"branchPoints":[{"name":"","internalFlags":4,"code":"req.session.isAuthenticated()","typeFullName":"","columnNumber":6,"order":1,"depthFirstOrder":-16,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":11,"id":1793433451611456500}],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":31,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":8,"id":1793433451611456500}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.path","typeFullName":"","columnNumber":19,"order":2,"depthFirstOrder":-26,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":9,"id":1793433451611456500}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-31,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":9,"id":1793433451611456500}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"followPath","internalFlags":4,"code":"followPath","typeFullName":"ANY","columnNumber":41,"order":2,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":2,"lineNumber":12,"id":1793433451611456500}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.addition","astParentFullName":"<global>","fullName":"<operator>.addition","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500}},{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700}}],"id":4355481239626405000},"dstTags":[{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"},{"id":4355481239626405400,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(\"http://example.com/\" + followPath)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"name":"<operator>.addition","internalFlags":4,"code":"\"http://example.com/\" + followPath","typeFullName":"","columnNumber":17,"order":2,"depthFirstOrder":-3,"methodFullName":"<operator>.addition","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":12,"id":1793433451611456500}},"id":4355481239626405400,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":21,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous","isExternal":false,"lineNumber":8,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"}],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD_ROUTE","value":"\"/login\"","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"}],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"attacker-to-redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Sensitive Data Leak: Attacker controlled data used in redirect via `req` in `anonymous`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"5.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"a1-injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"An attacker can redirect traffic from the application. This way the attacker could perform phishing attacks and/or steal sensitive data.\n\n\n## Countermeasures\n\nThis vulnerability can be prevented by validating all the data that is used to redirect users on different pages or website and by alerting the user before doing so.","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Sensitive Data Leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/redirect.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^express.Response^.redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"7548c86be44221fce91c2015807f5184","source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":30,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626405000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":30,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500},"_label":"SOURCE"},"cfgNodes":[{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":22,"order":1,"depthFirstOrder":-14,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500},{"internalFlags":4,"code":"query","columnNumber":22,"order":2,"depthFirstOrder":-13,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"query","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-12,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"internalFlags":4,"code":"url","columnNumber":22,"order":2,"depthFirstOrder":-11,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"url","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.url","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-10,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"encodeURI","astParentFullName":"<global>","fullName":"encodeURI","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398700,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626398700},{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.assignment","internalFlags":4,"code":"url = encodeURI(req.query.url)","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-8,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"<operator>.assignment","internalFlags":4,"code":"url = encodeURI(req.query.url)","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-8,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-7,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500},{"internalFlags":4,"code":"redirect","columnNumber":2,"order":2,"depthFirstOrder":-6,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"redirect","lineNumber":20,"id":1793433451611456500},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"res.redirect","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-5,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"res","internalFlags":4,"code":"res","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-4,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":20,"id":1793433451611456500},{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500},{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""}],"branchPoints":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":30,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":17,"id":1793433451611456500}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.query.url","typeFullName":"","columnNumber":22,"order":1,"depthFirstOrder":-10,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500}},{"method":{"name":"encodeURI","astParentFullName":"<global>","fullName":"encodeURI","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"+encoded","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_TRANSFORM","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"encode","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626398700}},{"method":{"name":"encodeURI","astParentFullName":"<global>","fullName":"encodeURI","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"+encoded","_label":"TAG"},{"id":4355481239626403300,"name":"FROM_OUTSIDE","value":"","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_TRANSFORM","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"TRANSFORMER_TYPE","value":"encode","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626398700}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"encodeURI","internalFlags":4,"code":"encodeURI(req.query.url)","typeFullName":"","columnNumber":12,"order":2,"depthFirstOrder":-9,"methodFullName":"encodeURI","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":18,"id":1793433451611456500}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"<operator>.assignment","astParentFullName":"<global>","fullName":"<operator>.assignment","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626405000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_OUT","id":4355481239626400300}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-15,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":18,"id":1793433451611456500}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"paramTags":[],"id":4355481239626405000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500}},{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"},{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700}}],"id":4355481239626405000},"dstTags":[{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405400,"name":"TRANSFORMER_TYPE","value":"encoded","_label":"TAG"},{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"},{"id":4355481239626405400,"name":"TO_OUTSIDE","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^express.Response^.redirect","astParentFullName":"<global>","fullName":"^express.Response^.redirect","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626397700,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626405000,"name":"TO_OUTSIDE","value":"redirect","_label":"TAG"}],"id":4355481239626405000,"callingMethod":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"},"methodTags":[{"id":4355481239626405000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"ANY","fullName":"ANY","typeDeclFullName":"ANY","id":102,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"res.redirect(url)","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-2,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":20,"id":1793433451611456500},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626397700},"node":{"dynamicTypeHintFullName":[],"name":"url","internalFlags":4,"code":"url","typeFullName":"ANY","columnNumber":15,"order":2,"depthFirstOrder":-3,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":20,"id":1793433451611456500}},"id":4355481239626405400,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/redirect.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":20,"depthFirstOrder":-16,"_label":"METHOD","code":"vulnerabilities/redirect.js::program:anonymous1","isExternal":false,"lineNumber":17,"id":1793433451611456500,"order":0,"filename":"vulnerabilities/redirect.js"}],"sourceDescriptorFlows":[],"dataTags":[{"id":4355481239626405400,"name":"SOURCE_VARIABLE","value":"req","_label":"TAG"},{"id":4355481239626405400,"name":"TRANSFORMER_TYPE","value":"encoded","_label":"TAG"},{"id":4355481239626405400,"name":"DEST_VARIABLE","value":"url","_label":"TAG"}],"sourceTags":[{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626405400,"name":"EXPOSED_METHOD_ROUTE","value":"\"/goto\"","_label":"TAG"},{"id":4355481239626405400,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"}],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"attacker-to-redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Sensitive Data Leak: Attacker controlled data used in redirect via `req` in `anonymous1`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"5.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"a1-injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"An attacker can redirect traffic from the application. This way the attacker could perform phishing attacks and/or steal sensitive data.\n\n\n## Countermeasures\n\nThis vulnerability can be prevented by validating all the data that is used to redirect users on different pages or website and by alerting the user before doing so.","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Sensitive Data Leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/redirect.js::program:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^express.Response^.redirect","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626404000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"798ada604ee5182dc34d3ff57f6e98ef","source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPRESSION","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPRESSION","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600},"_label":"SOURCE"},"cfgNodes":[{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600}],"branchPoints":[],"sink":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600}}],"id":4355481239626404000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":25,"depthFirstOrder":-27,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous1","isExternal":false,"lineNumber":13,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"","internalFlags":4,"code":"console.log(req.query.password)","typeFullName":"","columnNumber":4,"order":1,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":15,"id":3074457345618925600}},"id":4355481239626404000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626404000,"key":"name","value":"sensitive-response-leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"TitleTemplate","value":"Sensitive data from an external API response is leaked via log or persistent storage","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Score","value":"7.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Category","value":"A3-sensitive-data-exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"DescriptionTemplate","value":"HTTP data is written to a log file or persisted in an insecure storage in this flow.\n This data may be visible to a third party that has access to the logs or the local storage, such as system administrators. Many web applications and APIs do not protect sensitive data, such as financial and healthcare. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes.\n ## Countermeasures\n - This vulnerability can be prevented by not writing HTTP data directly to the log and the persistent storage or by sanitizing or obfuscating the data in advance.\n ## Additional information\n **[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n **[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n **[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"cwelink","value":"[CWE-200](https://cwe.mitre.org/data/definitions/200.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"owasplink","value":"[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Link","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"VulnerabilityDescription","value":"Sensitive Data Leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"source_method","value":"vulnerabilities/sensitive.js::program:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"sink_method","value":"vulnerabilities/sensitive.js::program:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"tags","value":"sensitive,leak","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626404000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"30d93a2b33bb4aa7f6662126e3d0a69c","source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":39,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","isExternal":false,"lineNumber":49,"id":2049638230412950500,"order":0,"filename":"vulnerabilities/nosqli.js"},"sourceType":"EXPRESSION","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"name":"","internalFlags":4,"code":"console.log(\"user registered\")","typeFullName":"","columnNumber":14,"order":2,"depthFirstOrder":-23,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":51,"id":2049638230412950800},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":39,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","isExternal":false,"lineNumber":49,"id":2049638230412950500,"order":0,"filename":"vulnerabilities/nosqli.js"},"sourceType":"EXPRESSION","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"name":"","internalFlags":4,"code":"console.log(\"user registered\")","typeFullName":"","columnNumber":14,"order":2,"depthFirstOrder":-23,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":51,"id":2049638230412950800},"_label":"SOURCE"},"cfgNodes":[{"name":"","internalFlags":4,"code":"console.log(\"user registered\")","typeFullName":"","columnNumber":14,"order":2,"depthFirstOrder":-23,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":51,"id":2049638230412950800}],"branchPoints":[],"sink":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":39,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","isExternal":false,"lineNumber":49,"id":2049638230412950500,"order":0,"filename":"vulnerabilities/nosqli.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"","internalFlags":4,"code":"console.log(\"user registered\")","typeFullName":"","columnNumber":14,"order":2,"depthFirstOrder":-23,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":51,"id":2049638230412950800}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":39,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","isExternal":false,"lineNumber":49,"id":2049638230412950500,"order":0,"filename":"vulnerabilities/nosqli.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"","internalFlags":4,"code":"console.log(\"user registered\")","typeFullName":"","columnNumber":14,"order":2,"depthFirstOrder":-23,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":51,"id":2049638230412950800}},{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":39,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","isExternal":false,"lineNumber":49,"id":2049638230412950500,"order":0,"filename":"vulnerabilities/nosqli.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"","internalFlags":4,"code":"console.log(\"user registered\")","typeFullName":"","columnNumber":14,"order":2,"depthFirstOrder":-23,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":51,"id":2049638230412950800}}],"id":4355481239626404000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"anonymous1","astParentFullName":"","fullName":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","signature":"","astParentType":"","internalFlags":4,"columnNumber":39,"depthFirstOrder":-32,"_label":"METHOD","code":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","isExternal":false,"lineNumber":49,"id":2049638230412950500,"order":0,"filename":"vulnerabilities/nosqli.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"","internalFlags":4,"code":"console.log(\"user registered\")","typeFullName":"","columnNumber":14,"order":2,"depthFirstOrder":-23,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":51,"id":2049638230412950800}},"id":4355481239626404000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626404000,"key":"name","value":"sensitive-response-leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"TitleTemplate","value":"Sensitive data from an external API response is leaked via log or persistent storage","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Score","value":"7.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Category","value":"A3-sensitive-data-exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"DescriptionTemplate","value":"HTTP data is written to a log file or persisted in an insecure storage in this flow.\n This data may be visible to a third party that has access to the logs or the local storage, such as system administrators. Many web applications and APIs do not protect sensitive data, such as financial and healthcare. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes.\n ## Countermeasures\n - This vulnerability can be prevented by not writing HTTP data directly to the log and the persistent storage or by sanitizing or obfuscating the data in advance.\n ## Additional information\n **[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n **[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n **[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"cwelink","value":"[CWE-200](https://cwe.mitre.org/data/definitions/200.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"owasplink","value":"[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Link","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"VulnerabilityDescription","value":"Sensitive Data Leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"source_method","value":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"sink_method","value":"vulnerabilities/nosqli.js::program:anonymous:_callee:_callee$:anonymous1","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"tags","value":"sensitive,leak","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626404000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"8983eadc5b282d7002c5da4e69114c29","source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPRESSION","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sourceType":"EXPRESSION","tags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600},"_label":"SOURCE"},"cfgNodes":[{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600}],"branchPoints":[],"sink":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600}},{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"paramTags":[],"id":4355481239626404000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600}}],"id":4355481239626404000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"anonymous","astParentFullName":"","fullName":"vulnerabilities/sensitive.js::program:anonymous","signature":"","astParentType":"","internalFlags":4,"columnNumber":24,"depthFirstOrder":-29,"_label":"METHOD","code":"vulnerabilities/sensitive.js::program:anonymous","isExternal":false,"lineNumber":6,"id":3074457345618925600,"order":0,"filename":"vulnerabilities/sensitive.js"},"sinkType":"EXPRESSION","parameterInTags":[],"id":4355481239626404000,"methodTags":[],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","node":{"name":"","internalFlags":4,"code":"console.log(password)","typeFullName":"","columnNumber":2,"order":4,"depthFirstOrder":-8,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":10,"id":3074457345618925600}},"id":4355481239626404000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626404000,"key":"name","value":"sensitive-response-leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"TitleTemplate","value":"Sensitive data from an external API response is leaked via log or persistent storage","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Score","value":"7.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Category","value":"A3-sensitive-data-exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"DescriptionTemplate","value":"HTTP data is written to a log file or persisted in an insecure storage in this flow.\n This data may be visible to a third party that has access to the logs or the local storage, such as system administrators. Many web applications and APIs do not protect sensitive data, such as financial and healthcare. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes.\n ## Countermeasures\n - This vulnerability can be prevented by not writing HTTP data directly to the log and the persistent storage or by sanitizing or obfuscating the data in advance.\n ## Additional information\n **[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n **[CWE-200](https://cwe.mitre.org/data/definitions/200.html)**\n **[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"cwelink","value":"[CWE-200](https://cwe.mitre.org/data/definitions/200.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"owasplink","value":"[OWASP-A3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"Link","value":"https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"VulnerabilityDescription","value":"Sensitive Data Leak","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"source_method","value":"vulnerabilities/sensitive.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"sink_method","value":"vulnerabilities/sensitive.js::program:anonymous","_label":"KEY_VALUE_PAIR"},{"id":4355481239626404000,"key":"tags","value":"sensitive,leak","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"},{"id":4355481239626406000,"evidence":[{"sinkDescriptorTags":[],"fingerprint":"a611722c1ced95de9e7b727269f3643f","source":{"method":{"name":"check","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:check","signature":"","astParentType":"","internalFlags":4,"columnNumber":0,"depthFirstOrder":-49,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:check","isExternal":false,"lineNumber":12,"id":3843071682023406600,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/check-user\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":15,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":12,"id":3843071682023406600},"_label":"SOURCE"},"literalsToSink":[],"primaryFlow":{"source":{"method":{"name":"check","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:check","signature":"","astParentType":"","internalFlags":4,"columnNumber":0,"depthFirstOrder":-49,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:check","isExternal":false,"lineNumber":12,"id":3843071682023406600,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"sourceType":"EXPOSED_PARAM","tags":[{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626406000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626406000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626406000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/check-user\"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"node":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":15,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":12,"id":3843071682023406600},"_label":"SOURCE"},"cfgNodes":[{"name":"check","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:check","signature":"","astParentType":"","internalFlags":4,"columnNumber":0,"depthFirstOrder":-49,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:check","isExternal":false,"lineNumber":12,"id":3843071682023406600,"order":0,"filename":"vulnerabilities/dep-lodash.js"},{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":6,"order":1,"depthFirstOrder":-48,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":13,"id":3843071682023406600},{"dynamicTypeHintFullName":[],"name":"_tmp_0","internalFlags":4,"code":"_tmp_0","typeFullName":"ANY","columnNumber":15,"order":1,"depthFirstOrder":-47,"_label":"IDENTIFIER","argumentIndex":-1,"lineNumber":13,"id":3843071682023406600},{"name":"<operator>.assignment","internalFlags":4,"code":"config = {}","typeFullName":"","columnNumber":2,"order":1,"depthFirstOrder":-46,"methodFullName":"<operator>.assignment","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":13,"id":3843071682023406600},{"dynamicTypeHintFullName":[],"name":"lodash","internalFlags":4,"code":"lodash","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-45,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":14,"id":3843071682023406600},{"internalFlags":4,"code":"defaultsDeep","columnNumber":2,"order":2,"depthFirstOrder":-44,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"defaultsDeep","lineNumber":14,"id":3843071682023406600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"lodash.defaultsDeep","typeFullName":"","columnNumber":2,"order":0,"depthFirstOrder":-43,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600},{"dynamicTypeHintFullName":[],"name":"lodash","internalFlags":4,"code":"lodash","typeFullName":"ANY","columnNumber":2,"order":1,"depthFirstOrder":-42,"_label":"IDENTIFIER","argumentIndex":0,"lineNumber":14,"id":3843071682023406600},{"dynamicTypeHintFullName":[],"name":"config","internalFlags":4,"code":"config","typeFullName":"ANY","columnNumber":22,"order":2,"depthFirstOrder":-41,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":14,"id":3843071682023406600},{"dynamicTypeHintFullName":[],"name":"req","internalFlags":4,"code":"req","typeFullName":"ANY","columnNumber":41,"order":1,"depthFirstOrder":-40,"_label":"IDENTIFIER","argumentIndex":1,"lineNumber":14,"id":3843071682023406600},{"internalFlags":4,"code":"body","columnNumber":41,"order":2,"depthFirstOrder":-39,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"body","lineNumber":14,"id":3843071682023406600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.body","typeFullName":"","columnNumber":41,"order":1,"depthFirstOrder":-38,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600},{"internalFlags":4,"code":"config","columnNumber":41,"order":2,"depthFirstOrder":-37,"_label":"FIELD_IDENTIFIER","argumentIndex":2,"canonicalName":"config","lineNumber":14,"id":3843071682023406600},{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.body.config","typeFullName":"","columnNumber":41,"order":1,"depthFirstOrder":-36,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600},{"name":"parse","internalFlags":4,"code":"JSON.parse(req.body.config)","typeFullName":"","columnNumber":30,"order":3,"depthFirstOrder":-35,"methodFullName":"JSON.parse","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600},{"name":"JSON.parse","astParentFullName":"<global>","fullName":"JSON.parse","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000},{"name":"parse","internalFlags":4,"code":"JSON.parse(req.body.config)","typeFullName":"","columnNumber":30,"order":3,"depthFirstOrder":-35,"methodFullName":"JSON.parse","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600},{"name":"","internalFlags":4,"code":"lodash.defaultsDeep(config, JSON.parse(req.body.config))","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-34,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600},{"name":"^lodash^.defaultsDeep","astParentFullName":"<global>","fullName":"^lodash^.defaultsDeep","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398000,"order":0,"filename":""}],"branchPoints":[],"sink":{"method":{"name":"^lodash^.defaultsDeep","astParentFullName":"<global>","fullName":"^lodash^.defaultsDeep","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"prototypePolution","_label":"TAG"}],"id":4355481239626406000,"callingMethod":{"name":"check","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:check","signature":"","astParentType":"","internalFlags":4,"columnNumber":0,"depthFirstOrder":-49,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:check","isExternal":false,"lineNumber":12,"id":3843071682023406600,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"lodash.defaultsDeep(config, JSON.parse(req.body.config))","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-34,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626398000},"node":{"name":"parse","internalFlags":4,"code":"JSON.parse(req.body.config)","typeFullName":"","columnNumber":30,"order":3,"depthFirstOrder":-35,"methodFullName":"JSON.parse","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600}},"transformations":[],"_label":"FLOW","points":[{"method":{"name":"check","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:check","signature":"","astParentType":"","internalFlags":4,"columnNumber":0,"depthFirstOrder":-49,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:check","isExternal":false,"lineNumber":12,"id":3843071682023406600,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"http","_label":"TAG"},{"id":4355481239626404000,"name":"FROM_OUTSIDE","value":"attacker-controlled","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/check-user\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":["HttpRequest"],"name":"req","evaluationStrategy":"BY_VALUE","code":"req","typeFullName":"","columnNumber":15,"order":1,"_label":"METHOD_PARAMETER_IN","lineNumber":12,"id":3843071682023406600}},{"method":{"name":"check","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:check","signature":"","astParentType":"","internalFlags":4,"columnNumber":0,"depthFirstOrder":-49,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:check","isExternal":false,"lineNumber":12,"id":3843071682023406600,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/check-user\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"<operator>.fieldAccess","internalFlags":4,"code":"req.body.config","typeFullName":"","columnNumber":41,"order":1,"depthFirstOrder":-36,"methodFullName":"<operator>.fieldAccess","_label":"CALL","argumentIndex":1,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600}},{"method":{"name":"JSON.parse","astParentFullName":"<global>","fullName":"JSON.parse","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p1","evaluationStrategy":"BY_VALUE","code":"p1","typeFullName":"ANY","order":1,"_label":"METHOD_PARAMETER_IN","id":4355481239626394000}},{"method":{"name":"JSON.parse","astParentFullName":"<global>","fullName":"JSON.parse","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626394000,"order":0,"filename":""},"paramTags":[],"id":4355481239626406000,"methodTags":[],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"evaluationStrategy":"BY_VALUE","internalFlags":0,"code":"RET","typeFullName":"ANY","order":-1,"depthFirstOrder":-2,"_label":"METHOD_RETURN","id":4355481239626394000}},{"method":{"name":"check","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:check","signature":"","astParentType":"","internalFlags":4,"columnNumber":0,"depthFirstOrder":-49,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:check","isExternal":false,"lineNumber":12,"id":3843071682023406600,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"paramTags":[],"id":4355481239626406000,"methodTags":[{"id":4355481239626404000,"name":"EXPOSED_METHOD","value":"","_label":"TAG"},{"id":4355481239626404000,"name":"EXPOSED_METHOD_ROUTE","value":"\"/check-user\"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"name":"parse","internalFlags":4,"code":"JSON.parse(req.body.config)","typeFullName":"","columnNumber":30,"order":3,"depthFirstOrder":-35,"methodFullName":"JSON.parse","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600}},{"method":{"name":"^lodash^.defaultsDeep","astParentFullName":"<global>","fullName":"^lodash^.defaultsDeep","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398000,"order":0,"filename":""},"paramTags":[{"id":4355481239626403300,"name":"TO_OUTSIDE","value":"prototypePolution","_label":"TAG"}],"id":4355481239626406000,"methodTags":[{"id":4355481239626403300,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"_label":"PROGRAM_POINT","elem":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626398000}}],"id":4355481239626406000},"dstTags":[],"sinkDescriptorFlows":[],"sink":{"method":{"name":"^lodash^.defaultsDeep","astParentFullName":"<global>","fullName":"^lodash^.defaultsDeep","signature":"","astParentType":"NAMESPACE_BLOCK","internalFlags":0,"depthFirstOrder":-1,"_label":"METHOD","code":"","isExternal":true,"id":4355481239626398000,"order":0,"filename":""},"sinkType":"ARG","parameterInTags":[{"id":4355481239626406000,"name":"TO_OUTSIDE","value":"prototypePolution","_label":"TAG"}],"id":4355481239626406000,"callingMethod":{"name":"check","astParentFullName":"","fullName":"vulnerabilities/dep-lodash.js::program:check","signature":"","astParentType":"","internalFlags":4,"columnNumber":0,"depthFirstOrder":-49,"_label":"METHOD","code":"vulnerabilities/dep-lodash.js::program:check","isExternal":false,"lineNumber":12,"id":3843071682023406600,"order":0,"filename":"vulnerabilities/dep-lodash.js"},"methodTags":[{"id":4355481239626406000,"name":"INTERFACE_WRITE","value":"","_label":"TAG"}],"nodeType":{"name":"","fullName":"","typeDeclFullName":"","id":4355481239626398700,"_label":"TYPE"},"_label":"SINK","callsite":{"name":"","internalFlags":4,"code":"lodash.defaultsDeep(config, JSON.parse(req.body.config))","typeFullName":"","columnNumber":2,"order":2,"depthFirstOrder":-34,"methodFullName":"","_label":"CALL","argumentIndex":-1,"dynamicTypeHintFullName":[],"dispatchType":"DYNAMIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600},"parameterIn":{"dynamicTypeHintFullName":[],"name":"p2","evaluationStrategy":"BY_VALUE","code":"p2","typeFullName":"ANY","order":2,"_label":"METHOD_PARAMETER_IN","id":4355481239626398000},"node":{"name":"parse","internalFlags":4,"code":"JSON.parse(req.body.config)","typeFullName":"","columnNumber":30,"order":3,"depthFirstOrder":-35,"methodFullName":"JSON.parse","_label":"CALL","argumentIndex":2,"dynamicTypeHintFullName":[],"dispatchType":"STATIC_DISPATCH","signature":"","lineNumber":14,"id":3843071682023406600}},"id":4355481239626406000,"sourceDescriptorTags":[],"transforms":[],"triggerMethods":[],"sourceDescriptorFlows":[],"dataTags":[],"sourceTags":[],"_label":"IOFLOW"}],"keyValuePairs":[{"id":4355481239626406000,"key":"name","value":"prototype-pollution","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"TitleTemplate","value":"Prototype Pollution: Attacker-controlled object leading to RCE or XSS via `req` in `check`","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Score","value":"7.0","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Category","value":"A1-injection","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"DescriptionTemplate","value":"An attacker-controlled object is used in a procedure that can change the `Object.prototype` property.\n This might allow an attacker to execute arbitrary code remotely, extract sensitive data from the system and compromise the integrity of the system completely.\n ## Countermeasures\n - Ensure `lodash` version `4.17.12+` is used with safer `merge` and `extend` functions.\n - Avoid using `defaultsDeep`, since the function can lead to object mutation.\n ## Additional information\n **[CWE-89](https://cwe.mitre.org/data/definitions/89.html)**\n **[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)**\n **[Javascript Object prototypes](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Object_prototypes)**","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"cwelink","value":"[CWE-250](https://cwe.mitre.org/data/definitions/250.html)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"owasplink","value":"[OWASP-A1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection)","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"Link","value":"https://cwe.mitre.org/data/definitions/250.html","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"VulnerabilityDescription","value":"Prototype Pollution","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"source_method","value":"vulnerabilities/dep-lodash.js::program:check","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"sink_method","value":"^lodash^.defaultsDeep","_label":"KEY_VALUE_PAIR"},{"id":4355481239626406000,"key":"tags","value":"","_label":"KEY_VALUE_PAIR"}],"_label":"FINDING"}]